<!DOCTYPE html>
<html lang=en>
<head>
    <meta charset="utf-8">
    
    <title>aenjon</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="aenjon Burning Life">
<meta property="og:type" content="website">
<meta property="og:title" content="aenjon">
<meta property="og:url" content="http://aenjon.com/index.html">
<meta property="og:site_name" content="aenjon">
<meta property="og:description" content="aenjon Burning Life">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="aenjon">
<meta name="twitter:description" content="aenjon Burning Life">
    

    

    
        <link rel="icon" href="/css/images/avatar.png" />
    

    <link rel="stylesheet" href="/vendor/font-awesome/css/font-awesome.min.css" type="text/css">
    <link rel="stylesheet" href="/vendor/open-sans/styles.css" type="text/css">
    <link rel="stylesheet" href="/vendor/source-code-pro/styles.css" type="text/css">

    <link rel="stylesheet" href="/css/style.css" type="text/css">

    <script src="/vendor/jquery/2.1.3/jquery.min.js" type="text/javascript"></script>
    
    
        <link rel="stylesheet" href="/vendor/fancybox/jquery.fancybox.css" type="text/css">
    
    
        <script type="text/javascript">
(function(i,s,o,g,r,a,m) {i['GoogleAnalyticsObject']=r;i[r]=i[r]||function() {
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-77554390-1', 'auto');
ga('send', 'pageview');

</script>
    
    
    
        <script>
var _hmt = _hmt || [];
(function() {
    var hm = document.createElement("script");
    hm.src = "//hm.baidu.com/hm.js?622a2108abaca144ab683efc8b9d1430";
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(hm, s);
})();
</script>

    

</head>
<body>
    <div id="container">
        <header id="header">
    <div id="header-main" class="header-inner">
        <div class="outer">
            <a href="/" id="logo">
                <i class="logo"></i>
                <span class="site-title">aenjon</span>
            </a>
            <nav id="main-nav">
                
                    <a class="main-nav-link" href="/.">Home</a>
                
                    <a class="main-nav-link" href="/archives">Archives</a>
                
                    <a class="main-nav-link" href="/categories">Categories</a>
                
                    <a class="main-nav-link" href="/tags">Tags</a>
                
                    <a class="main-nav-link" href="/projects/">Projects</a>
                
                    <a class="main-nav-link" href="/about">About</a>
                
            </nav>
            
                
                <nav id="sub-nav">
                    <div class="profile" id="profile-nav">
                        <a id="profile-anchor" href="javascript:;">
                            <img class="avatar" src="/css/images/avatar.png" />
                            <i class="fa fa-caret-down"></i>
                        </a>
                    </div>
                </nav>
            
            <div id="search-form-wrap">

    <form class="search-form">
        <input type="text" class="ins-search-input search-form-input" placeholder="Search" />
        <button type="submit" class="search-form-submit"></button>
    </form>
    <div class="ins-search">
    <div class="ins-search-mask"></div>
    <div class="ins-search-container">
        <div class="ins-input-wrapper">
            <input type="text" class="ins-search-input" placeholder="Type something..." />
            <span class="ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: 'Posts',
            PAGES: 'Pages',
            CATEGORIES: 'Categories',
            TAGS: 'Tags',
            UNTITLED: '(Untitled)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>
<script src="/js/insight.js" type="text/javascript"></script>

</div>
        </div>
    </div>
    <div id="main-nav-mobile" class="header-sub header-inner">
        <table class="menu outer">
            <tr>
                
                    <td><a class="main-nav-link" href="/.">Home</a></td>
                
                    <td><a class="main-nav-link" href="/archives">Archives</a></td>
                
                    <td><a class="main-nav-link" href="/categories">Categories</a></td>
                
                    <td><a class="main-nav-link" href="/tags">Tags</a></td>
                
                    <td><a class="main-nav-link" href="/projects/">Projects</a></td>
                
                    <td><a class="main-nav-link" href="/about">About</a></td>
                
                <td>
                    
    <div class="search-form">
        <input type="text" class="ins-search-input search-form-input" placeholder="Search" />
    </div>

                </td>
            </tr>
        </table>
    </div>
</header>

        <div class="outer">
            
                

<aside id="profile">
    <div class="inner profile-inner">
        <div class="base-info profile-block">
            <img id="avatar" src="/css/images/avatar.png" />
            <h2 id="name">aenjon</h2>
            <h3 id="title">Senior Engineer</h3>
            <span id="location"><i class="fa fa-map-marker"></i>ShenZhen, China</span>
            <a id="follow" target="_blank" href="https://github.com/aenjon">FOLLOW</a>
        </div>
        <div class="article-info profile-block">
            <div class="article-info-block">
                17
                <span>posts</span>
            </div>
            <div class="article-info-block">
                27
                <span>tags</span>
            </div>
        </div>
        
        <div class="profile-block social-links">
            <table>
                <tr>
                    
                    <td><a href="http://github.com/aenjon" target="_blank" title="github"><i class="fa fa-github"></i></a></td>
                    
                    <td><a href="http://stackoverflow.com/users/1343127/aenjon" target="_blank" title="stack-overflow"><i class="fa fa-stack-overflow"></i></a></td>
                    
                    <td><a href="http://weibo.com/aenjon" target="_blank" title="weibo"><i class="fa fa-weibo"></i></a></td>
                    
                    <td><a href="https://twitter.com/seraph_sky" target="_blank" title="twitter"><i class="fa fa-twitter"></i></a></td>
                    
                    <td><a href="/" target="_blank" title="facebook"><i class="fa fa-facebook"></i></a></td>
                    
                    <td><a href="/atom.xml" target="_blank" title="rss"><i class="fa fa-rss"></i></a></td>
                    
                </tr>
            </table>
        </div>
        
    </div>
</aside>

            
            <section id="main">
    <article id="post-aenjon/Life/而立之年，未开始的创业路" class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
        
        
            <header class="article-header">
                
    
        <h1 itemprop="name">
            <a class="article-title" href="/2016/10/31/aenjon/Life/而立之年，未开始的创业路/">而立之年，未开始的创业路</a>
        </h1>
    

                <div class="article-meta">
                    
    <div class="article-date">
        <i class="fa fa-calendar"></i>
        <a href="/2016/10/31/aenjon/Life/而立之年，未开始的创业路/">
            <time datetime="2016-10-30T16:30:30.000Z" itemprop="datePublished">2016-10-31</time>
        </a>
    </div>


                    
    <div class="article-category">
    	<i class="fa fa-folder"></i>
        <a class="article-category-link" href="/categories/aenjon/">aenjon</a><i class="fa fa-angle-right"></i><a class="article-category-link" href="/categories/aenjon/Life/">Life</a>
    </div>

                    
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/tags/Life/">Life</a>, <a class="tag-link" href="/tags/aenjon/">aenjon</a>
    </div>
          
					

					
                </div>
            </header>
        
        <div class="article-entry" itemprop="articleBody">
        
            
                <div id="toc" class="toc-article">
                <strong class="toc-title">Catalogue</strong>
                    <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#题记"><span class="toc-number">1.</span> <span class="toc-text">题记</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#A君"><span class="toc-number">2.</span> <span class="toc-text">A君</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#聊聊周围"><span class="toc-number">3.</span> <span class="toc-text">聊聊周围</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#这两年的一面之缘"><span class="toc-number">4.</span> <span class="toc-text">这两年的一面之缘</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#回到自己"><span class="toc-number">5.</span> <span class="toc-text">回到自己</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#到你了"><span class="toc-number">6.</span> <span class="toc-text">到你了</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#后记"><span class="toc-number">7.</span> <span class="toc-text">后记</span></a></li></ol>
                </div>
            
            <hr>
<p><img src="http://img9.itiexue.net/1049/10494897.jpg" alt="">  </p>
<h2 id="题记">题记</h2><p>“现代人不是渴望成功，而是渴望马上成功。”</p>
<p>前几天同一个创客类培训机构合伙人就合作事宜巴拉吧啦，一句话刺激到了小小的心脏，加上90后创业者的遍地开花🌼，似乎些许浮躁，香菇难受，辗转反侧，诸多思考，有了此文。</p>
<h2 id="A君">A君</h2><p>先从这位创业者（简称A君）说起吧。<br><strong>A</strong>，一位87年小伙，13年研究生毕业后校招进鹅厂，14年深圳宝安2w- 买了房解决了第一个生存问题，15年在一个老板给的200w启动资金下，与几个同事还有以前的同学一起创业，路演获取前海梦工厂创意园办公基地免费入驻…<br>他想让我加入他们培训体系中某个领域所谓的“权威人士”， 录制线上视频并兼线下培训高级讲师，与我之前合作过的几家大型线上/线下培训机构不同，聊天中他一味的强调他们平台多么多么N，可以将我包装成这个领域绝对的权威，签署排他协议，可以通过他们平台获得很好的声誉，还可以在它们的专栏中出售自己书籍/作品，当报名学员比较多时组织线下培训，培训费用以某个比例分成巴拉巴拉…说白了，没有实际利益，大饼的方式加上我个人时间确实差不多饱和，所以当场直接婉拒了。<br>然后继续聊他们的创业，讨论了一些关于创业的观点，巴拉巴拉，然后谈到我自己时，我说我的创业路一定会前行，但现在想先满足或者说解决部分生活上的财务自由再开始…他给我一句话刺到了我，“创业的话，真的不年轻了…”，然后提到他们公司现在招聘的都是90后，93/94年小伙子，有冲劲，技术也不错，Github上开源项目star也众多…面试时问 “大家技术都不错，相比别人，我们为什么要录用你而不是别人？”，”年轻资本，熬夜资本…” 这样的答复A自己都笑了，确实很现实，创业公司不多一份付出也不现实（说的有点委婉了），熬夜我们肯定熬不过他们年轻人，这是他们的资本，就如现在邀请我作为他们讲师也一样，这个领域让这群90后去啃，给一定的时间也完全不会有问题，他希望可以找一个既有地位的人来负责比较好（真厉害又被绕进去了）…后面还聊了很多，交换了微信和名片，嘱咐不要急着给答复回去权衡思考下，同他们一起把这件事有意义的事干一干…巴拉巴拉，又一大堆，这些都不重要了，我的思维还停留在他前面的那句话，“创业的话，真的不年轻了…”，是的，打算创业，30，而立之年，创业还未真正开始，慌？盲？迟？ 创业，真的想清楚了？</p>
<h2 id="聊聊周围">聊聊周围</h2><p><strong>B君</strong>，大学同学，14年离职后同三个同事创立了一家停车场相关公司，自己负责技术，其它三个负责资金和市场，股份平均（创业禁忌）。他们四人每人每月6k生活补贴，其它所有资金都作为储备资金，风风火火的干了一年，团队也从四人做到了十来个，月账面流水也从几万到几十万。<br>15年，B选择退出，以股份比例分到了一大笔钱。自己注册了另外一家公司，还是做原来的产品，跑华强北购买元器件，找PCB板商画板贴片再招人包装，然后跑市场积累客户，一年多下来，毛收入做到了200w。<br>现在的他，每天就是进货出货，跑跑市场谈谈主要客户，自由时间大把大把的，每天打打球陪陪小孩，从来没有10点前起过床，也经常找我聊聊是否有其它扩展门路，结合互联网如何来做巴拉巴拉…<br>说说他这个产品吧，很简单的一个小硬件产品，停车远距离刷卡，读头+卡片，主要赚取卡片插差价。14年15年很多次跟我聊天，说心里话，我压根就看不起这样的产品，这样的所谓“创业”，我跟他聊天灌输的思想一定是高大上的，一定是平台级的，一定是结合互联网，一定是大大的XX。现在，我会发现，错了，我有很多很多很好ideal，我有很好的互联网思维，我拥有技术，但创业或许是个伪命题，只是一个概念，那时的我纯粹的认为创业真的只是一种情怀，是为了情怀，从来没考虑过商业化的思想，突然感觉好像错了，创业，谈情怀之前先谈利益，赚到钱了能盈利才是企业，才是创业，才是中国现社会追从的成功人生。 是么？  </p>
<p><strong>C君</strong>，同校师兄，08年毕业来到深圳，从SCM到DSP到ARM，从普通工程师到现在某企业（中小企业，100多号人）总技术负责人，拥有企业的股份。他没有所谓的创业，但却能实现100w+的年收入，当然，单纯工作工资肯定没这么多，他在很早时通过别人介绍认识了他现在做的这个行业中某位台湾老板，当时完全不计较得失没日没夜的给他绘图做板开发，最终成为了长期合作伙伴维持并到现在，他们的产品在台北市拥有近乎1/3的市场…是的，他以工作和兼职的方式也在深圳立足下来，农村出生，今年（2016年喔）在深圳南山刚换了第二套房。 每次跟他爬塘朗山，聊天中会发现他是那种慢性子，做事有条不紊，绝不会去追求冒险。我不止一次问他为什么不创立一家公司，招一点人把事做大，他每次都笑一笑说道，成立公司又能怎么样呢？能赚的更多么？ 当时不理解，觉得太势利，目光看不远，只在乎短期利益，现在想想，其实也不然，雄浑大志之前一定也要脚踏实地，现在大多数互联网创业者，用所谓的互联网思维去创业，成天谈的就是融资圈钱甚至上市，通过融资去圈用户，然后再考虑如何盈利，是的动辄几百万甚至上千万融资（独角兽类公司毕竟是少数，我们需要那样的实例和憧憬，但短期还是先从产品做起），自身也华丽转身，转身之后呢？我希望的创业也是就酱紫的？  </p>
<p><strong>D君</strong>，初中同学，未读大学，职高毕业就来到了南广州，从事会展相关设计工作，前面和行业一个朋友一起成立了一家会展相关公司，承办国内外中小型会展设计与布展，目前公司十多个人，一部分是设计师，公司每年也有好几百w的毛收入。我们聚的不是很多，寥寥几次都是记忆深刻，总是带着我出入一些作为码农不太可能涉入的场合，such as夜总会、酒吧、棋牌室等，一群人聊的除了生意就是女人…这也是身边的一个创业者，有可以自己赖以生存的小公司，用他自己的话说反正比打工强。  </p>
<p>…</p>
<p>是的，上面介绍的都是身边的熟人朋友，做的事并不是纯互联网，或实业或者硬件相关，或许他们观点不太正确，甚至有点out，有点跟不上或者脱离我们现在吹的天花乱坠的互联网+的时代，但是，他们至少在他的那领域暂时可以说是成功的，获取了财富，获得了自己想要的，还有自由之身。当然，我周边也有一些互联网创业朋友，天天谈创业，谈融资，天天吹，很多都处在或惆怅融资或惆怅产品阶段，对此不评价…</p>
<h2 id="这两年的一面之缘">这两年的一面之缘</h2><p>这两年有太多创业者找我聊天，有过太多一面之缘，微信上有近乎150+个创业者信息，或创始人或CEO或CTO或合伙人或投资者。看了很多项目，聊了很多项目，也更加发现项目本身真的不那么重要，创业也真的想象中的那么高大上，简单聊聊几个。</p>
<p><strong>E君</strong>，一家传统行业的老板，有过行业多次创业经验，15年辞职到现在的公司任执行总裁，创始人是拥有多个摄影基地，拥有雄厚资本，一起创立的公司天使轮就2000w的融资，租赁了比较豪华奢侈有讲究的office，每次过去都是会在他们奢侈办公室喝茶聊项目，然后晚上入驻酒店。我给他们做了几个月的技术负责人，虽然一直要求我去全职入职做他们的技术总监/CTO，综合考虑后最终还是婉拒了。谈谈这个公司吧，才开始技术（双端App+服务端+Web页+公众号 全平台）是外包的，我加入的时候外包已经开始了，我跟进时发现外包公司技术很low，有点忽悠的感觉，招聘应届生来写不熟悉的代码。后面为了进度（定在某个时间需要新闻发布会，准备A轮融资），采取了一方面外包开发继续，一方面组建自己的技术团队，然后再通过自己技术团队逐步将外包可用代码和需求迭代过来，整个过程还是挺艰辛的，最终产品稍许delay后基本按期凑合发布了（发布前一晚还在熬夜赶业务调整需求，没法留出时间做任何性能或质量上的测试等等）。其实按道理说这是一个很不错的经历，团队是我自己组建的，各方面都还不错，但中间过程中我逐渐发现，总监E和Boss都是传统行业人，都不懂技术而且都不太重视技术，他们眼里技术只是为了完成他们这个App或者某个功能，很多时候沟通起来真费劲甚至有些可笑，我的那只团队成员中间近乎3个月没怎么休息过（有一个月全月都在工作，团队成员都单独找我私聊，我用各种理由把E说服后，后面才好些），每天加班赶需求改需求，纵然我给他们挡了很多，给E立了很多项目规范，建立需求池，培训敏捷迭代开发…但，很多都只是暂时的，很难建立一套真正的互联网化敏捷化的项目过程，甚至都很难以项目的方式推进…整个过程下来逐渐发现其实这不是自己想要的创业，想要的事业，想要的一起奋斗的团队，加入后也不会有太大改观，领导的思维很重要，有些固有思维几乎是不可该改变的，确实，纵然，资金+资源这块是E公司最大的优势（这也是我见了几十家创业公司中资源和资本最充足的），但拼凑的团队以及太多传统行业的束缚以及对技术的不重视，会觉得这家企业不会走很长远，不会做的足够大，这是我当时的判断。现在这家公司线下还是做的火热火热的（整合和合作了众多线下一线品牌加盟商），几个月了线上却还只有几千的用户量，日活也少的可怜，比起我自己做的一些App都少很多。是的，创业，团队和资源同样重要，创始人的思维更重要，有什么的思维注定了可以你的团队，你的企业，你的事业可以走多远，所以，创业者的思维，你准备好了么？ </p>
<p><strong>F君</strong>，一家3D打印平台的CEO/创始人，她在这个行业一直做了近20年，对整个相关联的实体了解颇深（3D打印商等），也正好赶上习大大的一带一路政策，所以就夫妻一起在14年底注册了这家公司来做这样一个平台，深受当地政府的厚重（跟我聊天时将她与市长的微信聊天记录给我看，展览时国家部级领导人参观交流的照片等），政府免费提供了一层楼给其办公，公司人员就十来个，融了两次资（私人老板），第一次200w，10%的股份；第二次200w，5%的股份。 我们见了两次面，一次是她来我上班的地方，咖啡馆里简单聊了两个小时，第二次是在15年底，她公司的城市，我们聊了一整天，上午在其办公室，中午餐馆，下午办公室园区，一直再聊。个人直觉对这样一个行业，领域是非常的看好和认同，CEO眼光也不错，内心希望加入（回家后还跟媳妇商量了好久），但最终没有去成，败在现实利益面前。我们后面邮件往来了很多次主要是沟通待遇利益问题，CTO职位，她最终能给的股份期权非常有限，而且受限很大（不是一次性给），而工资就很少了，基本就是万把块钱的基本生活费，考虑到当时自己的情况，纠结了好久最后选择了放弃。这是自己现在回想会觉得有丝许后悔的为数不多一件事，其实，那时的我也不懂什么创业不创业，仅仅是凭自己的直觉，认为这件事可以为之，认可这样一个领域和产品，却败给了现实的自己。 现在的我反思，总结出创业最最重要的一点，是你必须认可这样一件事，这样才能全身心有激情的去当作自己的事业奋斗，但，同时，创业之路是有风险的，不可能考虑太多现实物质基础的，这样，你真的准备好了么？</p>
<p><strong>G君</strong>，应该是一位富二代，从他第二次深夜里开着加长版大奔（恕我浅薄，第一次在深圳见到）来我住的地方判断的（当时车上还坐着一位美女，然后犹豫找不着停车位就让她在车上等着，我俩找了个小店深聊到凌晨1点多）。他从事的是银行放贷这一块的，手里有很多资源，已经有好几家公司，他想做一个放贷相关的金融平台，然后提到马云，然后巴拉巴拉…后面又跟我聊了很多金融相关的东东，包括谈到很多现实的问题，例如在深圳没房，他说保证我明年不出一分钱拥有一套房，具体如何通过资本运作获得跟我详细讲了，听的我云里雾里…是的，他是玩资本的，而且玩了很多年了，国内外资本兼备，对金融完全陌生的我对他有些感到害怕（实话说长这么大还没具体说害怕过某个人）和胆怯…他要求我立即辞职，第二天就去他高大上办公室开始干起，具体他要做的事我都事晕的没有思考的余地，针对马上辞职这个观点，我试着辩解说这不太可能，他马上说提供高额补贴，巴拉巴拉…感觉在他面前我完全没有任何话语权，这是我长这么大从来没有遇到的事…我当时只好回复说要回去同媳妇商量下再决定，当然最后还是没去。 后面和一些朋友聊到这事，他们都说我的抉择是正确的，至少我认为，对于创业，至少要在你熟悉的领域进行，完全陌生的领域，虽然你只需要负责技术，但这不应该叫创业，所以，创业，这个领域你熟悉么？<br>（ps，现在朋友圈看到G经常晒各种照片，非常成功，各种投资，上月还看到其参加第十一届中国中小企业企业家创新发展大会中拿奖…只能说是一枚有魄力有资本有资源的领导者，服…只是资本的世界现在的我真的不懂～）</p>
<p><strong>H君</strong>，没见过面但留有印象，外包做了一个智慧问答平台，纯互联网项目，他的思想一直说这个项目是他自己这辈子真正想要做的事，自己出资金找外包团队做，不考虑融资（至少暂时），只想好好的把这样一件事做好…巴拉巴拉，这样的聊天让我感觉有点异类，真的可以做到在自己资金并不是那么充裕的前提下出资来做一件情怀的事情或产品么，这值得尊重和记忆。 他也跟我沟通，说他CTO有两三个人选，感觉我面相上像，有一种领导者的感觉，所以选我（当时听了，挺舒服的，第一次听人这样夸我…），但我们都还一直没见过面哦，他也不急，说等外包产品完成并发布后我再介入…就这样，中间等到了两个多月，在这段时间里，我在他的那个产品相关的群里逐渐发现，其实，项目除外，他并不是我想象中的那样情怀，很多可能只是言语上的高大上，或者只是我还太嫩…，当然，至少我认为，对于创业，情怀的东西需要要，但只有情怀我觉得是干不好一件事情的，就如我之前提到的，做企业你必须要考虑盈利，不以营利为目的的企业都是耍流氓。</p>
<p><strong>I君、J君</strong>，…</p>
<p>…</p>
<h2 id="回到自己">回到自己</h2><blockquote>
<p>创业是什么？</p>
</blockquote>
<p>我认为的创业，只是一种信息的不对称下，风口面前，事物或东西的归属，或许是你，或许是他人，区别点在于，站在风口面前的你，对这种不对称信息的了解和熟知（Ideal），你的资本是否可以经得起风口风的力度（资源／技术／团队等）？ （By aenjon 2016）</p>
<blockquote>
<p>你真的需要创业么？ </p>
</blockquote>
<p>你需要创业么？ 你真的需要创业么？ 这里不想谈太多其它主观客观巴拉巴拉讨论，仅一点，你想通过创业获得什么？  财富？ 地位？ 情怀？ 梦想？ 或许是其中之一，但它们不矛盾，你冒着风险，一定抉择后艰辛旅程后这些都只是结果，仅是结果产物。 我更希望的创业是在一定的时机和阶段，做一件自己想要为之的事，把它做成，留一点东西在这个社会，让复杂的事加上你的用心变的简单，仅此而已。</p>
<p>知乎一句话比较直接的击中了现在很多打工人的心。 “认真读书，拿好成绩，上好大学，找好工作，去大公司。努力在公司奋斗30年，费劲力气往上爬，不乱花销，攒钱买房子，做投资。等到退休了，就是有钱人了。相信这个，并且为之付出200%的努力的，就是穷人思维”。 对比一下，前半段是我经历了经历着，似乎没得选择；后半段之前没有考虑过的，以后也不会这样考虑，不曾想过打工可以成为自己的事业，可以实现财富自由，当然，创业也未必，但有可能。为了这种可能，你觉得呢？  </p>
<blockquote>
<p>我的创业路</p>
</blockquote>
<p>任正非，43岁，华为，87年；<br>马云，35岁，阿里，99年；<br>马化腾，27岁，腾讯，98年；<br>…</p>
<p>创业是一件水到渠成的事，是人人可以为之的事，所以，不着急，不忧虑，试着梳理自己的Ideal，择一其二慢慢实现，沉下心里做几件自己想做的事，相信该来的一切都会来临。<br>而立之年，你的创业元年。 </p>
<h2 id="到你了">到你了</h2><p>你觉得呢？ </p>
<h2 id="后记">后记</h2><p>同步发表/转载 <a href="">cnBlogs</a> / <a href="">CSDN</a> / <a href=""></a> …</p>
<p>By aenjon 10/2016 SZ China   </p>
<hr>
<p><strong><em>版权声明</em></strong></p>
<font size="1"><br> <a href="http://aenjon.com">aenjon</a> by <a href="http://aenjon.com/about">aenjon</a> is licensed under a <a href="http://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank" rel="external">Creative Commons BY-NC-ND 4.0 International License</a>.<br>由<a href="http://aenjon.com/about">Bob</a>创作并维护的<a href="http://aenjon.com">aenjon</a>博客采用<a href="http://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank" rel="external">创作共用保留署名-非商业-禁止演绎4.0国际许可证</a>.<br>本文首发于<a href="http://aenjon.com">aenjon</a>博客（ <a href="http://aenjon.com">http://aenjon.com</a> ），版权归作者所有，欢迎转载，但未经作者同意必须保留此段声明，且在文章页面明显位置给出原文连接，否则保留追究法律责任的权利。<br></font>

<p>微信扫码打赏<a href="http://aenjon.com">aenjon</a><br><img src="/css/images/aenjon_wx.png" alt=""> </p>
<p>如果您愿意捐助其它金额<a href="http://aenjon.com/about">请戳我~~</a>，扫码支付宝/微信</p>
<p>本文永久链接：<a href="http://aenjon.com/2016/10/31/aenjon/Life/而立之年，未开始的创业路/">http://aenjon.com/2016/10/31/aenjon/Life/而立之年，未开始的创业路/</a></p>

        
        </div>
        <footer class="article-footer">
            <div class="share-container">


    <div class="bdsharebuttonbox">
    <a href="#" class="bds_more" data-cmd="more">分享到：</a>
    <a href="#" class="bds_qzone" data-cmd="qzone" title="分享到QQ空间">QQ空间</a>
    <a href="#" class="bds_tsina" data-cmd="tsina" title="分享到新浪微博">新浪微博</a>
    <a href="#" class="bds_tqq" data-cmd="tqq" title="分享到腾讯微博">腾讯微博</a>
    <a href="#" class="bds_renren" data-cmd="renren" title="分享到人人网">人人网</a>
    <a href="#" class="bds_weixin" data-cmd="weixin" title="分享到微信">微信</a>
</div>
<script>
window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"0","bdSize":"16"},"share":{"bdSize":16}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];
</script>
<style>
    .bdshare_popup_box {
        border-radius: 4px;
        border: #e1e1e1 solid 1px;
    }
    .bdshare-button-style0-16 a,
    .bdshare-button-style0-16 .bds_more {
        padding-left: 20px;
        margin: 6px 10px 6px 0;
    }
    .bdshare_dialog_list a,
    .bdshare_popup_list a,
    .bdshare_popup_bottom a {
        font-family: 'Microsoft Yahei';
    }
    .bdshare_popup_top {
        display: none;
    }
    .bdshare_popup_bottom {
        height: auto;
        padding: 5px;
    }
</style>


</div>

            
    
        <a href="http://aenjon.com/2016/10/31/aenjon/Life/而立之年，未开始的创业路/#comments" class="article-comment-link disqus-comment-count" data-disqus-url="http://aenjon.com/2016/10/31/aenjon/Life/而立之年，未开始的创业路/">Comments</a>
    

        </footer>
    </div>
    
</article>



    <article id="post-Tools/Jenkins Gitlab持续集成打包平台搭建" class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
        
        
            <header class="article-header">
                
    
        <h1 itemprop="name">
            <a class="article-title" href="/2016/07/18/Tools/Jenkins Gitlab持续集成打包平台搭建/">Jenkins Gitlab持续集成打包平台搭建</a>
        </h1>
    

                <div class="article-meta">
                    
    <div class="article-date">
        <i class="fa fa-calendar"></i>
        <a href="/2016/07/18/Tools/Jenkins Gitlab持续集成打包平台搭建/">
            <time datetime="2016-07-17T16:00:00.000Z" itemprop="datePublished">2016-07-18</time>
        </a>
    </div>


                    
    <div class="article-category">
    	<i class="fa fa-folder"></i>
        <a class="article-category-link" href="/categories/Tech/">Tech</a><i class="fa fa-angle-right"></i><a class="article-category-link" href="/categories/Tech/Tools/">Tools</a>
    </div>

                    
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/tags/Android/">Android</a>, <a class="tag-link" href="/tags/CI/">CI</a>, <a class="tag-link" href="/tags/Gitlab/">Gitlab</a>, <a class="tag-link" href="/tags/Jenkins/">Jenkins</a>, <a class="tag-link" href="/tags/iOS/">iOS</a>
    </div>
          
					

					
                </div>
            </header>
        
        <div class="article-entry" itemprop="articleBody">
        
            
                <div id="toc" class="toc-article">
                <strong class="toc-title">Catalogue</strong>
                    <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#相关概念"><span class="toc-number">1.</span> <span class="toc-text">相关概念</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Jenkins"><span class="toc-number">1.1.</span> <span class="toc-text">Jenkins</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Gitlab"><span class="toc-number">1.2.</span> <span class="toc-text">Gitlab</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CI"><span class="toc-number">1.3.</span> <span class="toc-text">CI</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#OTA"><span class="toc-number">1.4.</span> <span class="toc-text">OTA</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#pgyer"><span class="toc-number">1.5.</span> <span class="toc-text">pgyer</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#流程结构"><span class="toc-number">2.</span> <span class="toc-text">流程结构</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#平台搭建"><span class="toc-number">3.</span> <span class="toc-text">平台搭建</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Jenkins安装和启动"><span class="toc-number">3.1.</span> <span class="toc-text">Jenkins安装和启动</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Jenkins插件安装"><span class="toc-number">3.2.</span> <span class="toc-text">Jenkins插件安装</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Jenkins系统设置"><span class="toc-number">3.3.</span> <span class="toc-text">Jenkins系统设置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Jenkins_Jobs配置"><span class="toc-number">3.4.</span> <span class="toc-text">Jenkins Jobs配置</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Jobs基础配置"><span class="toc-number">3.4.1.</span> <span class="toc-text">Jobs基础配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Jobs源码库配置(Gitlab为例)"><span class="toc-number">3.4.2.</span> <span class="toc-text">Jobs源码库配置(Gitlab为例)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Jobs触发条件配置"><span class="toc-number">3.4.3.</span> <span class="toc-text">Jobs触发条件配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Jobs构建方式/编译_配置"><span class="toc-number">3.4.4.</span> <span class="toc-text">Jobs构建方式/编译 配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Jobs构建后处理"><span class="toc-number">3.4.5.</span> <span class="toc-text">Jobs构建后处理</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#后记"><span class="toc-number">4.</span> <span class="toc-text">后记</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#签名和证书问题(iOS)"><span class="toc-number">4.1.</span> <span class="toc-text">签名和证书问题(iOS)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#邮件发送失败"><span class="toc-number">4.2.</span> <span class="toc-text">邮件发送失败</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Jenkins_Https_Support"><span class="toc-number">4.3.</span> <span class="toc-text">Jenkins Https Support</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Refs"><span class="toc-number">5.</span> <span class="toc-text">Refs</span></a></li></ol>
                </div>
            
            <hr>
<h1 id="相关概念">相关概念</h1><h2 id="Jenkins">Jenkins</h2><ul>
<li><a href="https://jenkins.io/index.html" target="_blank" rel="external">Jenkins</a>，一个用Java编写的开源的持续集成工具，提供了软件开发的持续集成服务，可监控并触发持续重复的工作，具有开源，支持多平台和插件扩展，安装简单，界面化管理等特点。更多介绍参考<a href="https://en.wikipedia.org/wiki/Jenkins_(software" target="_blank" rel="external">维基</a>介绍.  </li>
</ul>
<h2 id="Gitlab">Gitlab</h2><ul>
<li>GitLab是一个利用Ruby on Rails开发的开源应用程序，实现一个自托管的Git项目仓库，可通过Web界面进行访问公开的或者私人项目，更多介绍参考<a href="https://en.wikipedia.org/wiki/GitLab" target="_blank" rel="external">维基</a>介绍.</li>
</ul>
<h2 id="CI">CI</h2><ul>
<li>持续集成, 简称CI（continuous integration）.</li>
<li>CI作为敏捷开发重要的一步，其目的在于让产品快速迭代的同时，尽可能保持高质量.</li>
<li>CI一种可以增加项目可见性，降低项目失败风险的开发实践。其每一次代码更新，都要通过自动化测试来检测代码和功能的正确性，只有通过自动测试的代码才能进行后续的交付和部署.</li>
<li>CI 是团队成员间（产研测）更好地协调工作，更好的适应敏捷迭代开发，自动完成减少人工干预，保证每个时间点上团队成员提交的代码都能成功集成的，可以很好的用于对Android/iOS项目的打包.</li>
</ul>
<h2 id="OTA">OTA</h2><ul>
<li>OTA（Over-the-Air Technology）空中下载技术,具体参<a href="https://support.apple.com/en-us/HT201435" target="_blank" rel="external">考此文介绍</a>.</li>
</ul>
<h2 id="pgyer">pgyer</h2><ul>
<li><a href="https://www.pgyer.com/apps" target="_blank" rel="external">蒲公英(pgyer)</a>为移动开发者提供App免费测试分发应用的服务平台，支持iOS与Android，简单两步分发应用。类似的还有fir.im等.</li>
</ul>
<h1 id="流程结构">流程结构</h1><p>简单绘制了下Jenkins的一个流程，如下图：</p>
<p><img src="http://7xo4q8.com1.z0.glb.clouddn.com/aenjon/2016/Jenkins%E6%B5%81%E7%A8%8B-min.png" alt="">  </p>
<p><a href="http://www.ibm.com/developerworks/cn/devops/d-continuous-delivery-framework-jenkins/" target="_blank" rel="external">IBM Developer</a>上也有一个看似更复杂一点的图，如下图<br><img src="http://www.ibm.com/developerworks/cn/devops/d-continuous-delivery-framework-jenkins/image007.png" alt="">   </p>
<p>持续交互流程图：<br><img src="http://www.ibm.com/developerworks/cn/devops/d-continuous-delivery-framework-jenkins/image006.png" alt="">  </p>
<h1 id="平台搭建">平台搭建</h1><h2 id="Jenkins安装和启动">Jenkins安装和启动</h2><p><a href="https://jenkins.io/index.html" target="_blank" rel="external">官网</a>： <a href="https://jenkins.io/index.html" target="_blank" rel="external">https://jenkins.io/index.html</a><br><a href="http://mirrors.jenkins-ci.org/war/latest/jenkins.war" target="_blank" rel="external">下载</a>： <a href="http://mirrors.jenkins-ci.org/war/latest/jenkins.war" target="_blank" rel="external">http://mirrors.jenkins-ci.org/war/latest/jenkins.war</a>  </p>
<blockquote>
<p>安装： </p>
</blockquote>
<ul>
<li>依赖于Java环境，首先安装和配置<a href="http://www.oracle.com/technetwork/java/javase/downloads/index.html" target="_blank" rel="external">Java环境</a>  </li>
<li>到<a href="https://jenkins.io/index.html" target="_blank" rel="external">官网</a>下载Jenkins,双击安装，如果是Mac电脑，会自动生成全局变量jenkins  </li>
<li>修改参数： jenkins + 相关参数，如<br>jenkins –httpPort=8888  #更换端口号，当默认端口8080被占用，或指定特定端口时。</li>
</ul>
<blockquote>
<p>启动  </p>
</blockquote>
<ul>
<li>手动启动： java  -jar jenkins.war  </li>
<li>后台启动(默认端口)： nohup java -jar jenkins.war &amp;  </li>
<li>后台启动(指定端口)： nohup java -jar jenkins.war -httpPort=88 &amp;  </li>
<li>后台启动(HTTPS)： nohup java -jar jenkins.war -httpsPort=88 &amp;  </li>
<li>浏览：<a href="http://localhost:8080/" target="_blank" rel="external">http://localhost:8080/</a>  , localhost可配置</li>
</ul>
<h2 id="Jenkins插件安装">Jenkins插件安装</h2><blockquote>
<p>插件安装</p>
</blockquote>
<p>操作： Manage Jenkins -&gt; Manage Plugins -&gt; Available -&gt; Search -&gt; Click to install，如下图所示</p>
<p><img src="http://7xo4q8.com1.z0.glb.clouddn.com/aenjon/2016/Jenkins-%E6%8F%92%E4%BB%B6%E5%AE%89%E8%A3%851-min.png" alt="">   </p>
<p><img src="http://7xo4q8.com1.z0.glb.clouddn.com/aenjon/2016/Jenkins-%E6%8F%92%E4%BB%B6%E5%AE%89%E8%A3%852-min.png" alt="">  </p>
<blockquote>
<p>实用插件</p>
</blockquote>
<ul>
<li>iOS专用：Xcode integration  </li>
<li>Android专用：Gradle plugin </li>
<li>Gitlab插件：GitLab Plugin 和 Gitlab Hook Plugin   </li>
<li>Git插件： Git plugin  </li>
<li>GitBuckit插件： GitBuckit plugin   </li>
<li>签名证书管理插件:  Credentials Plugin 和Keychains and Provisioning Profiles Management  </li>
<li>FTP插件:  Publish over FTP  </li>
<li>脚本插件: Post-Build Script Plug-in  </li>
<li>修改Build名称/描述(二维码)： build-name-setter / description setter plugin</li>
<li>获取仓库提交的commit log： Git Changelog Plugin  </li>
<li>自定义全局变量: Environment Injector Plugin  </li>
<li>自定义邮件插件： Email Extension Plugin  </li>
<li>获取当前登录用户信息： build-user-vars-plugin </li>
<li>显示代码测试覆盖率报表： Cobertura Plugin   </li>
<li>来展示生成的单元测试报表，支持一切单测框架，如junit、nosetests等： Junit Plugin</li>
<li>其它： GIT plugin / SSH Credentials Plugin</li>
</ul>
<h2 id="Jenkins系统设置">Jenkins系统设置</h2><p>操作： Manage Jenkins -&gt; Configure System </p>
<ul>
<li>Jenkins内部shell UTF-8 编码设置，如下图所示</li>
</ul>
<p><img src="http://7xo4q8.com1.z0.glb.clouddn.com/aenjon/2016/Jenkins-%E8%AE%BE%E7%BD%AE1-min.png" alt="">  </p>
<ul>
<li>Jenkins Location和Email设置，如下图所示</li>
</ul>
<p><img src="http://7xo4q8.com1.z0.glb.clouddn.com/aenjon/2016/Jenkins-%E8%AE%BE%E7%BD%AE2-min.png" alt="">  </p>
<ul>
<li>E-mail Notification，设置如下如所示</li>
</ul>
<p><img src="http://7xo4q8.com1.z0.glb.clouddn.com/aenjon/2016/Jenkis%E7%B3%BB%E7%BB%9F%E8%AE%BE%E7%BD%AE3-min.png" alt="Jenkis系统设置3"></p>
<p>SMTP详细配置请参考 <a href="http://www.nailedtothex.org/roller/kyle/entry/articles-jenkins-email" target="_blank" rel="external">How to send Email at every build with Jenkins</a>  </p>
<h2 id="Jenkins_Jobs配置">Jenkins Jobs配置</h2><h3 id="Jobs基础配置">Jobs基础配置</h3><blockquote>
<p>配置编译参数</p>
</blockquote>
<p>例如，如果需要打包者自行选择打包类型，如需要编译Release/Debug/Test等不同版本的包，那需要配置Jobs的编译参数，配置方法如下图所示：</p>
<p><img src="http://7xo4q8.com1.z0.glb.clouddn.com/aenjon/2016/Jenkins%E7%BC%96%E8%AF%91%E8%AE%BE%E7%BD%AE-%E5%8F%82%E6%95%B0%E8%AE%BE%E7%BD%AE2-min.png" alt="Jenkins编译设置-参数设置2"></p>
<p>你还可以配置一些其它参数，例如：</p>
<p><img src="http://7xo4q8.com1.z0.glb.clouddn.com/aenjon/2016/Jenkins%E7%BC%96%E8%AF%91%E8%AE%BE%E7%BD%AE-%E5%8F%82%E6%95%B0%E8%AE%BE%E7%BD%AE3-min.png" alt="Jenkins编译设置-参数设置3"></p>
<p>配置完后，build界面中就会出现，如下如所示：</p>
<p><img src="http://7xo4q8.com1.z0.glb.clouddn.com/aenjon/2016/Jenkins%E7%BC%96%E8%AF%91%E8%AE%BE%E7%BD%AE-%E5%8F%82%E6%95%B0%E8%AE%BE%E7%BD%AE1-min.png" alt="Jenkins编译设置-参数设置1"></p>
<p><a href="http://stackoverflow.com/questions/7751735/how-to-configure-a-single-jenkins-job-to-make-the-release-process-from-trunk-or" target="_blank" rel="external">How to configure a single Jenkins job to make the release process from trunk or branches?</a></p>
<blockquote>
<p>配置匿名用户权限</p>
</blockquote>
<p>后面打包的应用发布时，如果懒得自己搭建服务器，就用Jenkins的，但发布出去的链接需要登录才能访问，这时候你可以设置匿名用户的访问权限，这样匿名用户可以下载访问你提供的应用链接了，非常取巧的方法，如下图：</p>
<p><img src="http://7xo4q8.com1.z0.glb.clouddn.com/aenjon/2016/Jenkins%E7%BC%96%E8%AF%91%E8%AE%BE%E7%BD%AE-%E5%8F%82%E6%95%B0%E8%AE%BE%E7%BD%AE4-min.png" alt="Jenkins编译设置-参数设置4.png"></p>
<h3 id="Jobs源码库配置(Gitlab为例)">Jobs源码库配置(Gitlab为例)</h3><blockquote>
<p>配置SSH</p>
</blockquote>
<p>操作： Manage Jenkins -&gt; Credentials -&gt; Global credentials (unrestricted) -&gt; Add Credentials</p>
<ol>
<li>本机生成SSH：ssh-keygen -t rsa -C “Your email” ， 生成过程中需设置密码，最终生成id_rsa和id_rsa.pub(公钥)  </li>
<li>本机添加秘钥到SSH：ssh-add 文件名（需输入管理密码）  </li>
<li>Gitlab上添加公钥：复制id_rsa.pub里面的公钥添加到Gitlab    </li>
<li>Jenkins上配置密钥到SSH：复制id_rsa.pub里面的公钥添加到Jenkins（private key选项）  </li>
</ol>
<blockquote>
<p>新建Job  </p>
</blockquote>
<p>在Jenkins中，所有的任务都是以”Job”为单位的。在进行操作前，你需要新建一个Job，Job新建比较简单，只需要在Jenkins管理的首页左侧，点击“New Job”，一般选择free-style software project，再输入Job的名字即可。</p>
<blockquote>
<p>配置Gitlab</p>
</blockquote>
<p>在新建的任务（Jobs）中，Gitlab源码配置如下图：需要输入git仓库和build分支，公钥使用上面配置SSH生成的公钥。</p>
<p><img src="http://7xo4q8.com1.z0.glb.clouddn.com/aenjon/2016/Jenkins-%E9%A1%B9%E7%9B%AE%E8%AE%BE%E7%BD%AE1-min.png" alt="">    </p>
<h3 id="Jobs触发条件配置">Jobs触发条件配置</h3><p>Jenkins支持多种触发器配置，包括：</p>
<ul>
<li><p>定期进行构建（Build periodically），定时器使用示例如下：  </p>
<p>  H(25-30) 18 <em> </em> 1-5： 工作日下午6点25到30分之间进行build<br>  H 23 <em> </em> 1-5：工作日每晚23:00至23:59之间的某一时刻进行build<br>  H(0-29)/15 <em> </em> <em> </em>：前半小时内每隔15分钟进行build（开始时间不确定）<br>  H/20 <em> </em> <em> </em>：每隔20分钟进行build（开始时间不确定）   </p>
</li>
<li><p>根据提交进行构建（Build when a change is pushed to GitHub）</p>
</li>
<li>定期检测代码更新，如有更新则进行构建（Poll SCM）</li>
</ul>
<h3 id="Jobs构建方式/编译_配置">Jobs构建方式/编译 配置</h3><p>Jenkins支持多种编译配置方式，包括：</p>
<ul>
<li>Xcode: iOS编译配置（安装Xcode integration插件） </li>
<li>Invoke Gradle script：  Android编译配置(安装Gradle plugin插件)   </li>
<li>Exceute Shell： 脚本方式  </li>
</ul>
<p>对于iOS应用的构建，如果选择Xcode方式构建，需要配置好开发者证书，具体参考后面签名和整数问题。<br>推荐使用Exceute Shell方式，简单有效。</p>
<h3 id="Jobs构建后处理">Jobs构建后处理</h3><blockquote>
<p>Artifacts和邮件通知配置，参考下图   </p>
</blockquote>
<p><img src="http://7xo4q8.com1.z0.glb.clouddn.com/aenjon/2016/Jenkins%E9%A1%B9%E7%9B%AE%E8%AE%BE%E7%BD%AE-Archive-min.png" alt="Jenkins项目设置-Archive-min">  </p>
<p>可借助Email Extension Plugin 插件进行详细配置，具体可参考<a href="http://blog.csdn.net/fengshi_sh/article/details/50669754" target="_blank" rel="external">此文</a></p>
<p><img src="http://7xo4q8.com1.z0.glb.clouddn.com/aenjon/2016/Jenkins%E9%A1%B9%E7%9B%AE%E8%AE%BE%E7%BD%AE-%E9%82%AE%E4%BB%B6-min.png" alt="Jenkins项目设置-邮件-min">  </p>
<blockquote>
<p>发布</p>
</blockquote>
<ul>
<li>FTP服务器, 最传统的方式，可助蒲公英或者fir.im（安装对应的Jenkins插件）。</li>
<li>专业的Artifacts存储仓库, 比如Nexus, Artifactory等。</li>
<li>对象存储服务：比如阿里云OSS，AWS S3等，以阿里云为例，具体请参考此文 <a href="http://blog.fit2cloud.com/2015/01/20/aliyun-oss-jenkins-plugin.html" target="_blank" rel="external">在Jenkins持续集成方案中使用阿里云OSS作为Artifacts仓库</a>  </li>
</ul>
<p>当然，如果不想自己的应用发布到三方网站，只希望在自己的内网上托管，这样需要在自己内网上搭建服务器，服务器搭建方式有很多种，Mac上可以用自带的Apache服务，也可以用其它服务。</p>
<p>iOS的发布可能希望用到OTA，可参考<a href="http://blog.csdn.net/close_marty/article/details/38559673" target="_blank" rel="external">此文</a>  还有这篇<a href="http://www.jianshu.com/p/35ca63ec0d8e" target="_blank" rel="external">一步一步实现无线安装iOS应用(内网OTA)</a> </p>
<p>这里分享一个我写的shell脚本模板(<a href="https://github.com/aenjon/PlistAutoCreate" target="_blank" rel="external">已开源</a>)，可以用于iOS的plist文件自动创建以及OTA简单发布页面的自动创建，参考<a href="https://github.com/aenjon/PlistAutoCreate" target="_blank" rel="external">此链接获取源码</a>, 欢迎Star.</p>
<p>自动生成一个简单HTML界面，如下图，点击Install即可安装：</p>
<p><img src="http://7xo4q8.com1.z0.glb.clouddn.com/aenjon/2016/jenkins_index.png" alt="Jenkis发布1">  </p>
<p>注意，这里iOS7.1以后限定必须要要用https，所以需要对jenkins设置下https，参考下面”后记” 中的Jenkins Https设置</p>
<blockquote>
<p>Last Show  </p>
</blockquote>
<p>构建成功后最终的结果如下如所示：</p>
<p><img src="http://7xo4q8.com1.z0.glb.clouddn.com/aenjon/2016/jenkins_finish.jpg" alt="">  </p>
<h1 id="后记">后记</h1><h2 id="签名和证书问题(iOS)">签名和证书问题(iOS)</h2><ul>
<li><a href="https://circleci.com/docs/ios-code-signing/" target="_blank" rel="external">Set up code signing for iOS projects</a></li>
<li><a href="http://eqi.cc/2016/05/17/%E5%AE%89%E8%A3%85jenkins%E5%88%B0%E5%8F%91%E5%B8%83ipa%E4%B8%AD%E7%9A%84%E9%82%A3%E4%BA%9B%E5%9D%91/" target="_blank" rel="external">安装JENKINS到发布IPA中的那些坑</a></li>
</ul>
<h2 id="邮件发送失败">邮件发送失败</h2><ul>
<li>实际搭建过程中有遇到此问题，折腾了小会，还以为是公司邮箱地址为题，后面发现仅仅是一个小配置问题。</li>
<li>Extended E-mail Notification中也需要和E-mail Notification一样，点击Advanced，然后选择Use SMTP Authentication，配置同E-mail Notification的参数。</li>
</ul>
<h2 id="Jenkins_Https_Support">Jenkins Https Support</h2><p>查询Jenkins Https相关命令： </p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -jar jenkins.war --<span class="keyword">help</span> | <span class="keyword">grep</span> -<span class="keyword">i</span> https</span><br></pre></td></tr></table></figure>
<p>说明：下面以Mac为例.</p>
<blockquote>
<p>KeyStore方式</p>
</blockquote>
<ul>
<li>生成： </li>
</ul>
<figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="label">keytool</span> -genkey -keyalg RSA -<span class="preprocessor">alias</span> <span class="keyword">selfsigned </span>-keystore keystore.jks -storepass 密码 -dname <span class="string">"cn=WEB"</span></span><br></pre></td></tr></table></figure>
<ul>
<li>使用： </li>
</ul>
<figure class="highlight brainfuck"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">java</span> <span class="literal">-</span><span class="comment">jar</span> <span class="comment">jenkins</span><span class="string">.</span><span class="comment">war</span> <span class="literal">-</span><span class="literal">-</span><span class="comment">httpPort=</span><span class="literal">-</span><span class="comment">1</span> <span class="literal">-</span><span class="literal">-</span><span class="comment">httpsPort=8080</span> <span class="literal">-</span><span class="literal">-</span><span class="comment">httpsKeyStore=/目录/keystore</span><span class="string">.</span><span class="comment">jks</span> <span class="literal">-</span><span class="literal">-</span><span class="comment">httpsKeyStorePassword=密码</span></span><br></pre></td></tr></table></figure>
<ul>
<li>注意： 第一次使用时需要将”WEB”证书导入，导入步骤为：Chrome导出证书 -&gt; 安装证书 -&gt; 设置证书”全部允许”， 图解步骤可参考下面实用参考中的第5篇文章.</li>
</ul>
<blockquote>
<p>Certificate方式  </p>
</blockquote>
<ul>
<li>生成：</li>
</ul>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo openssl genrsa -out server<span class="class">.key</span> <span class="number">2048</span>  </span><br><span class="line">sudo openssl req -new -key server<span class="class">.key</span> -out server<span class="class">.csr</span>  </span><br><span class="line">sudo openssl genrsa  -out ca<span class="class">.key</span> <span class="number">1024</span>  </span><br><span class="line">sudo openssl req  -new -x509 -days <span class="number">365</span> -key ca<span class="class">.key</span> -out ca<span class="class">.crt</span>  </span><br><span class="line">sudo openssl ca -<span class="keyword">in</span> server<span class="class">.csr</span> -out server<span class="class">.crt</span> -cert ca<span class="class">.crt</span> -keyfile ca.key</span><br></pre></td></tr></table></figure>
<ul>
<li>使用：</li>
</ul>
<p>启动Jenkins:<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -jar jenkins<span class="class">.war</span> --httpsPort=<span class="number">8088</span> --httpsCertificate=/path/server<span class="class">.crt</span> --httpsPrivateKey=/path/server.key</span><br></pre></td></tr></table></figure></p>
<ul>
<li>注意/说明：<br>1 同上<br>2 iOS手机需要导入cer证书(ca.crt)<br>3 Common Name  填写IP地址或域名地址<br>4 第5步骤如果提提示“I am unable to access the ./demoCA/newcerts directory” 错误，解决方法为：<br>在当前操作目录，新建demoCA\newcerts2层文件夹<br>然后再demoCA文件夹下新建一个空的index.txt文件<br>再新建一个serial文件，没有后缀。里面填入01  </li>
</ul>
<blockquote>
<p>实用参考   </p>
</blockquote>
<ul>
<li><a href="https://wiki.jenkins-ci.org/display/JENKINS/Starting+and+Accessing+Jenkins" target="_blank" rel="external">Starting and Accessing Jenkins</a>  官网说明</li>
<li><a href="http://balodeamit.blogspot.hk/2014/03/jenkins-switch-to-ssl-https-mode.html" target="_blank" rel="external">Jenkins: Switch to SSL/ HTTPS mode</a>  支持HTTPS的两种方式</li>
<li><a href="https://wiki.wocommunity.org/display/documentation/Installing+and+Configuring+Jenkins" target="_blank" rel="external">Installing and Configuring Jenkins</a>  KeyStore方式</li>
<li><a href="https://discuss.zendesk.com/hc/en-us/articles/202652748-Generating-a-self-signed-SSL-certificate-using-the-Java-keytool-command-2004193-" target="_blank" rel="external">Generating a self-signed SSL certificate using the Java keytool command (2004193)</a>  KeyStore方式</li>
<li><a href="http://www.andrewconnell.com/blog/setup-self-signed-certificates-trusting-them-on-os-x#ZAUu13DJEy2AYEYM.99" target="_blank" rel="external">Setup Self-Signed Certificates &amp; Trusting them on OS X</a>  Certificate方式</li>
<li><a href="http://nassir.iteye.com/blog/1983613" target="_blank" rel="external">免费openssl生成ssl证书</a>   Certificate方式   </li>
<li><a href="https://github.com/hughperkins/howto-jenkins-ssl" target="_blank" rel="external">howto-jenkins-ssl</a>  </li>
<li><a href="https://support.cloudbees.com/hc/en-us/articles/226744608-Jenkins-fails-to-Start-due-to-HttpsConnectorFactory" target="_blank" rel="external">Jenkins fails to Start due to HttpsConnectorFactory</a>  </li>
<li><a href="http://yuur369.iteye.com/blog/1720321" target="_blank" rel="external">openssl 生成服务端证书所遇到的问题</a>  </li>
</ul>
<h1 id="Refs">Refs</h1><ul>
<li><a href="https://wiki.jenkins-ci.org/display/JENKINS/Use+Jenkins" target="_blank" rel="external">Using Jenkins</a></li>
<li><a href="https://wiki.jenkins-ci.org/display/JENKINS/Building+a+software+project" target="_blank" rel="external">Building a software project</a></li>
<li><a href="https://danielbeard.wordpress.com/2013/04/23/auto-build-and-deploy-ios-apps-using-jenkins/" target="_blank" rel="external">Auto build and deploy iOS apps using Jenkins</a>  </li>
<li><a href="http://savvyapps.com/blog/continuous-integration-ios-jenkins" target="_blank" rel="external">Continuous Integration for iOS with Jenkins</a>  </li>
<li><a href="http://docs.gitlab.com/ee/integration/jenkins.html#jenkins-ci-deprecated-service" target="_blank" rel="external">GitLab Documentation</a> </li>
<li><a href="https://felixha.wordpress.com/2014/04/24/luu-bi/" target="_blank" rel="external">Setup Jenkins + TestFlight for iOS apps</a>    </li>
<li><a href="https://nickcharlton.net/posts/installing-jenkins-osx-yosemite.html" target="_blank" rel="external">Installing Jenkins on OS X Yosemite</a></li>
<li><a href="https://www.ibm.com/developerworks/cn/java/j-lo-jenkins/" target="_blank" rel="external">基于 Jenkins 快速搭建持续集成环境</a>  </li>
<li><a href="http://files.cnblogs.com/files/itech/Jenkins%E5%85%A5%E9%97%A8.pdf" target="_blank" rel="external">Jenkins入门</a>  </li>
<li><a href="http://blog.csdn.net/close_marty/article/details/38559673" target="_blank" rel="external">jenkins中集成OTA发布</a>  </li>
</ul>
<hr>
<font size="2"><br>By aenjon-2016<br></font>

<hr>
<p><strong><em>版权声明</em></strong></p>
<font size="1"><br> <a href="http://aenjon.com">aenjon</a> by <a href="http://aenjon.com/about">aenjon</a> is licensed under a <a href="http://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank" rel="external">Creative Commons BY-NC-ND 4.0 International License</a>.<br>由<a href="http://aenjon.com/about">Bob</a>创作并维护的<a href="http://aenjon.com">aenjon</a>博客采用<a href="http://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank" rel="external">创作共用保留署名-非商业-禁止演绎4.0国际许可证</a>.<br>本文首发于<a href="http://aenjon.com">aenjon</a>博客（ <a href="http://aenjon.com">http://aenjon.com</a> ），版权归作者所有，欢迎转载，但未经作者同意必须保留此段声明，且在文章页面明显位置给出原文连接，否则保留追究法律责任的权利。<br></font>

<p>微信扫码打赏<a href="http://aenjon.com">aenjon</a><br><img src="/css/images/aenjon_wx.png" alt=""> </p>
<p>如果您愿意捐助其它金额<a href="http://aenjon.com/about">请戳我~~</a>，扫码支付宝/微信</p>
<p>本文永久链接：<a href="http://aenjon.com/2016/07/18/Tools/Jenkins">http://aenjon.com/2016/07/18/Tools/Jenkins</a> Gitlab持续集成打包平台搭建/</p>

        
        </div>
        <footer class="article-footer">
            <div class="share-container">


    <div class="bdsharebuttonbox">
    <a href="#" class="bds_more" data-cmd="more">分享到：</a>
    <a href="#" class="bds_qzone" data-cmd="qzone" title="分享到QQ空间">QQ空间</a>
    <a href="#" class="bds_tsina" data-cmd="tsina" title="分享到新浪微博">新浪微博</a>
    <a href="#" class="bds_tqq" data-cmd="tqq" title="分享到腾讯微博">腾讯微博</a>
    <a href="#" class="bds_renren" data-cmd="renren" title="分享到人人网">人人网</a>
    <a href="#" class="bds_weixin" data-cmd="weixin" title="分享到微信">微信</a>
</div>
<script>
window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"0","bdSize":"16"},"share":{"bdSize":16}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];
</script>
<style>
    .bdshare_popup_box {
        border-radius: 4px;
        border: #e1e1e1 solid 1px;
    }
    .bdshare-button-style0-16 a,
    .bdshare-button-style0-16 .bds_more {
        padding-left: 20px;
        margin: 6px 10px 6px 0;
    }
    .bdshare_dialog_list a,
    .bdshare_popup_list a,
    .bdshare_popup_bottom a {
        font-family: 'Microsoft Yahei';
    }
    .bdshare_popup_top {
        display: none;
    }
    .bdshare_popup_bottom {
        height: auto;
        padding: 5px;
    }
</style>


</div>

            
    
        <a href="http://aenjon.com/2016/07/18/Tools/Jenkins Gitlab持续集成打包平台搭建/#comments" class="article-comment-link disqus-comment-count" data-disqus-url="http://aenjon.com/2016/07/18/Tools/Jenkins Gitlab持续集成打包平台搭建/">Comments</a>
    

        </footer>
    </div>
    
</article>



    <article id="post-iOS/Select all the cell in UITabView or UICollectionView problem" class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
        
        
            <header class="article-header">
                
    
        <h1 itemprop="name">
            <a class="article-title" href="/2016/06/30/iOS/Select all the cell in UITabView or UICollectionView problem/">Select all the cell in UITabView or UICollectionView problem</a>
        </h1>
    

                <div class="article-meta">
                    
    <div class="article-date">
        <i class="fa fa-calendar"></i>
        <a href="/2016/06/30/iOS/Select all the cell in UITabView or UICollectionView problem/">
            <time datetime="2016-06-29T16:40:20.000Z" itemprop="datePublished">2016-06-30</time>
        </a>
    </div>


                    
    <div class="article-category">
    	<i class="fa fa-folder"></i>
        <a class="article-category-link" href="/categories/Tech/">Tech</a><i class="fa fa-angle-right"></i><a class="article-category-link" href="/categories/Tech/iOS/">iOS</a>
    </div>

                    
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/tags/Swift/">Swift</a>, <a class="tag-link" href="/tags/iOS/">iOS</a>
    </div>
          
					

					
                </div>
            </header>
        
        <div class="article-entry" itemprop="articleBody">
        
            
                <div id="toc" class="toc-article">
                <strong class="toc-title">Catalogue</strong>
                    <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#The_Issue"><span class="toc-number">1.</span> <span class="toc-text">The Issue</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Solutions_in_NetWork"><span class="toc-number">2.</span> <span class="toc-text">Solutions in NetWork</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#The_real_Solution"><span class="toc-number">3.</span> <span class="toc-text">The real Solution</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Ref"><span class="toc-number">4.</span> <span class="toc-text">Ref</span></a></li></ol>
                </div>
            
            <hr>
<h1 id="The_Issue">The Issue</h1><p>Recently in my new project I need to select all the cell data in my UITabViewCell and UICollectionViewCell, and need to do some operations with all the cells(like delete etc.), What I do as follows:</p>
<blockquote>
<p>UITabView  </p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="func"><span class="keyword">func</span> <span class="title">selectAll</span><span class="params">(select: Bool)</span></span> &#123;</span><br><span class="line">    <span class="keyword">let</span> numSections = mListTableView?.numberOfSections</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">let</span> numSections = numSections &#123;</span><br><span class="line">        <span class="keyword">for</span> numSection <span class="keyword">in</span>  <span class="number">0</span> ..&lt; numSections&#123;</span><br><span class="line">            <span class="keyword">let</span> numItems = mListTableView?.numberOfRowsInSection(numSection)</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">let</span> numItems = numItems &#123;</span><br><span class="line">                <span class="keyword">for</span> numItem <span class="keyword">in</span> <span class="number">0</span> ..&lt; numItems &#123;</span><br><span class="line">                    selectCell(<span class="type">NSIndexPath</span>(forRow: numItem, inSection: numSection), select: select)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="func"><span class="keyword">func</span> <span class="title">selectCell</span><span class="params">(indexPath : NSIndexPath, select: Bool)</span></span> &#123;</span><br><span class="line">    <span class="keyword">if</span> mListTableView?.cellForRowAtIndexPath(indexPath) != <span class="literal">nil</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> cell = mListTableView?.cellForRowAtIndexPath(indexPath) <span class="keyword">as</span>! <span class="type">DownloadListViewCell</span></span><br><span class="line">        <span class="comment">//cell.setSelected(select, animated: true)</span></span><br><span class="line">        cell.setSelectForDelete(select)  <span class="comment">// select status UI in UITabViewCell</span></span><br><span class="line">        mDownloadList[indexPath.row].selectToDelete = select  <span class="comment">// Pojo data</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>UICollectionView  </p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="func"><span class="keyword">func</span> <span class="title">selectAll</span><span class="params">(select: Bool)</span></span> &#123;</span><br><span class="line">    <span class="keyword">let</span> numSections = mMyOfflineCollectView?.numberOfSections()</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">let</span> numSections = numSections &#123;</span><br><span class="line">        <span class="keyword">for</span> numSection <span class="keyword">in</span>  <span class="number">0</span> ..&lt; numSections&#123;</span><br><span class="line">            <span class="keyword">let</span> numItems = mMyOfflineCollectView?.numberOfItemsInSection(numSection)</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">let</span> numItems = numItems &#123;</span><br><span class="line">                <span class="keyword">for</span> numItem <span class="keyword">in</span> <span class="number">0</span> ..&lt; numItems &#123;</span><br><span class="line">                    selectCell(<span class="type">NSIndexPath</span>(forRow: numItem, inSection: numSection), flag: select)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="func"><span class="keyword">func</span> <span class="title">selectCell</span><span class="params">(indexPath : NSIndexPath, flag: Bool)</span></span> &#123;</span><br><span class="line">    <span class="keyword">if</span> mMyOfflineCollectView.cellForItemAtIndexPath(indexPath) != <span class="literal">nil</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> cell = mMyOfflineCollectView.cellForItemAtIndexPath(indexPath) <span class="keyword">as</span>! <span class="type">MyOfflineCollectionViewCell</span></span><br><span class="line">        cell.setSelect(flag)</span><br><span class="line">        <span class="keyword">if</span> flag &#123;</span><br><span class="line">            mMyOfflineCollectView.selectItemAtIndexPath(indexPath, animated: <span class="literal">true</span>, scrollPosition: <span class="type">UICollectionViewScrollPosition</span>.<span class="type">None</span>)</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            mMyOfflineCollectView.deselectItemAtIndexPath(indexPath, animated: <span class="literal">true</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        mMyofflinesData[indexPath.row].needDelete = flag</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>But</strong>, The problem is , I can only select the visible cell  when I scoll down or up, or do operations</p>
<h1 id="Solutions_in_NetWork">Solutions in NetWork</h1><p><a href="http://stackoverflow.com/questions/22861804/uicollectionview-cellforitematindexpath-is-nil" target="_blank" rel="external">UICollectionView cellForItemAtIndexPath is nil</a></p>
<p><a href="http://stackoverflow.com/questions/21469459/cellforitematindexpath-returns-nil-after-force-scrolling-to-make-it-visible" target="_blank" rel="external">cellForItemAtIndexPath returns nil after force scrolling to make it visible</a></p>
<p><a href="http://stackoverflow.com/questions/1524043/select-all-the-cells-in-uitableview" target="_blank" rel="external">Select all the cells in UITableView</a></p>
<p><a href="http://stackoverflow.com/questions/21168393/easier-way-to-select-all-rows-in-uitableview" target="_blank" rel="external">Easier way to select all rows in UITableView</a></p>
<p><a href="http://stackoverflow.com/questions/32748447/tableview-cellforrowatindexpath-returns-nil-with-too-many-cells-swift" target="_blank" rel="external">tableView.cellForRowAtIndexPath returns nil with too many cells (swift)</a></p>
<p><a href="http://stackoverflow.com/questions/31188893/tableview-cellforrowatindexpathindexpath-return-nil" target="_blank" rel="external">tableView.cellForRowAtIndexPath(indexPath) return nil</a></p>
<h1 id="The_real_Solution">The real Solution</h1><p>The real problem happened at the cellForRowAtIndexPath / cellForItemAtIndexPath, Which defined in Apple as follows:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="func"><span class="keyword">func</span> <span class="title">cellForRowAtIndexPath</span><span class="params">(indexPath: NSIndexPath)</span></span> -&gt; <span class="type">UITableViewCell</span>? </span><br><span class="line"><span class="comment">// returns nil if cell is **not visible** or index path is out of range</span></span><br></pre></td></tr></table></figure>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="func"><span class="keyword">func</span> <span class="title">cellForItemAtIndexPath</span><span class="params">(indexPath: NSIndexPath)</span></span> -&gt; <span class="type">UICollectionViewCell</span>?</span><br></pre></td></tr></table></figure>
<p>When the cell is not visible, the cellForRowAtIndexPath will return <strong>nil</strong>,<br>So, it’s not the right way to do the cell select operation out the<br>UITableViewDataSource in cellForRowAtIndexPath (UITabView), <strong>you should do it separate</strong>. The right way as follows:   </p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="func"><span class="keyword">func</span> <span class="title">tableView</span><span class="params">(tableView: UITableView, cellForRowAtIndexPath indexPath: NSIndexPath)</span></span> -&gt; <span class="type">UITableViewCell</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> cell = tableView.dequeueReusableCellWithIdentifier(<span class="type">DOWNLOAD_LIST_CELL_INDENTIFIER</span>, forIndexPath: indexPath) <span class="keyword">as</span>! <span class="type">DownloadListViewCell</span></span><br><span class="line">    cell.selectionStyle = <span class="type">UITableViewCellSelectionStyle</span>.<span class="type">None</span>        </span><br><span class="line">    <span class="comment">// ...  </span></span><br><span class="line">   cell.setSelectForDelete(<span class="keyword">self</span>.mDownloadList[indexPath.row].selectToDelete)<span class="comment">// select status UI in UITabViewCell</span></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="keyword">return</span> cell</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="func"><span class="keyword">func</span> <span class="title">selectCell</span><span class="params">(indexPath : NSIndexPath, select: Bool)</span></span> &#123;</span><br><span class="line">    mDownloadList[indexPath.row].selectToDelete = select <span class="comment">// Pojo data</span></span><br><span class="line">    mListTableView?.reloadData() <span class="comment">// reloadData</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="Ref">Ref</h1><p><a href="https://developer.apple.com/library/ios/documentation/UIKit/Reference/UITableView_Class/index.html#//apple_ref/occ/instm/UITableView/cellForRowAtIndexPath:" target="_blank" rel="external">UITableView</a></p>
<p><a href="https://developer.apple.com/reference/uikit/uicollectionview" target="_blank" rel="external">UICollectionView</a></p>
<hr>
<font size="2"><br>By aenjon-2016<br></font>

<hr>
<p><strong><em>版权声明</em></strong></p>
<font size="1"><br> <a href="http://aenjon.com">aenjon</a> by <a href="http://aenjon.com/about">aenjon</a> is licensed under a <a href="http://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank" rel="external">Creative Commons BY-NC-ND 4.0 International License</a>.<br>由<a href="http://aenjon.com/about">Bob</a>创作并维护的<a href="http://aenjon.com">aenjon</a>博客采用<a href="http://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank" rel="external">创作共用保留署名-非商业-禁止演绎4.0国际许可证</a>.<br>本文首发于<a href="http://aenjon.com">aenjon</a>博客（ <a href="http://aenjon.com">http://aenjon.com</a> ），版权归作者所有，欢迎转载，但未经作者同意必须保留此段声明，且在文章页面明显位置给出原文连接，否则保留追究法律责任的权利。<br></font>

<p>微信扫码打赏<a href="http://aenjon.com">aenjon</a><br><img src="/css/images/aenjon_wx.png" alt=""> </p>
<p>如果您愿意捐助其它金额<a href="http://aenjon.com/about">请戳我~~</a>，扫码支付宝/微信</p>
<p>本文永久链接：<a href="http://aenjon.com/2016/06/30/iOS/Select">http://aenjon.com/2016/06/30/iOS/Select</a> all the cell in UITabView or UICollectionView problem/</p>

        
        </div>
        <footer class="article-footer">
            <div class="share-container">


    <div class="bdsharebuttonbox">
    <a href="#" class="bds_more" data-cmd="more">分享到：</a>
    <a href="#" class="bds_qzone" data-cmd="qzone" title="分享到QQ空间">QQ空间</a>
    <a href="#" class="bds_tsina" data-cmd="tsina" title="分享到新浪微博">新浪微博</a>
    <a href="#" class="bds_tqq" data-cmd="tqq" title="分享到腾讯微博">腾讯微博</a>
    <a href="#" class="bds_renren" data-cmd="renren" title="分享到人人网">人人网</a>
    <a href="#" class="bds_weixin" data-cmd="weixin" title="分享到微信">微信</a>
</div>
<script>
window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"0","bdSize":"16"},"share":{"bdSize":16}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];
</script>
<style>
    .bdshare_popup_box {
        border-radius: 4px;
        border: #e1e1e1 solid 1px;
    }
    .bdshare-button-style0-16 a,
    .bdshare-button-style0-16 .bds_more {
        padding-left: 20px;
        margin: 6px 10px 6px 0;
    }
    .bdshare_dialog_list a,
    .bdshare_popup_list a,
    .bdshare_popup_bottom a {
        font-family: 'Microsoft Yahei';
    }
    .bdshare_popup_top {
        display: none;
    }
    .bdshare_popup_bottom {
        height: auto;
        padding: 5px;
    }
</style>


</div>

            
    
        <a href="http://aenjon.com/2016/06/30/iOS/Select all the cell in UITabView or UICollectionView problem/#comments" class="article-comment-link disqus-comment-count" data-disqus-url="http://aenjon.com/2016/06/30/iOS/Select all the cell in UITabView or UICollectionView problem/">Comments</a>
    

        </footer>
    </div>
    
</article>



    <article id="post-Android/一种提高Android应用进程存活率新方法" class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
        
        
            <header class="article-header">
                
    
        <h1 itemprop="name">
            <a class="article-title" href="/2016/06/19/Android/一种提高Android应用进程存活率新方法/">一种提高Android应用进程存活率新方法</a>
        </h1>
    

                <div class="article-meta">
                    
    <div class="article-date">
        <i class="fa fa-calendar"></i>
        <a href="/2016/06/19/Android/一种提高Android应用进程存活率新方法/">
            <time datetime="2016-06-18T16:40:20.000Z" itemprop="datePublished">2016-06-19</time>
        </a>
    </div>


                    
    <div class="article-category">
    	<i class="fa fa-folder"></i>
        <a class="article-category-link" href="/categories/Tech/">Tech</a><i class="fa fa-angle-right"></i><a class="article-category-link" href="/categories/Tech/Android/">Android</a>
    </div>

                    
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/tags/Android/">Android</a>, <a class="tag-link" href="/tags/存活率/">存活率</a>, <a class="tag-link" href="/tags/进程/">进程</a>
    </div>
          
					

					
                </div>
            </header>
        
        <div class="article-entry" itemprop="articleBody">
        
            
                <div id="toc" class="toc-article">
                <strong class="toc-title">Catalogue</strong>
                    <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#基础知识"><span class="toc-number">1.</span> <span class="toc-text">基础知识</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Android_进程优先级"><span class="toc-number">1.1.</span> <span class="toc-text">Android 进程优先级</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Android_Low_Memory_Killer"><span class="toc-number">1.2.</span> <span class="toc-text">Android Low Memory Killer</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#查看某个App的进程"><span class="toc-number">1.3.</span> <span class="toc-text">查看某个App的进程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Linux_AM命令"><span class="toc-number">1.4.</span> <span class="toc-text">Linux AM命令</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#NotificationListenerService"><span class="toc-number">1.5.</span> <span class="toc-text">NotificationListenerService</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Android账号和同步机制"><span class="toc-number">1.6.</span> <span class="toc-text">Android账号和同步机制</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Android多进程"><span class="toc-number">1.7.</span> <span class="toc-text">Android多进程</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#现有方法"><span class="toc-number">2.</span> <span class="toc-text">现有方法</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#网络连接保活方法"><span class="toc-number">2.1.</span> <span class="toc-text">网络连接保活方法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#双service(通知栏)_提高进程优先级"><span class="toc-number">2.2.</span> <span class="toc-text">双service(通知栏) 提高进程优先级</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Service及时拉起"><span class="toc-number">2.3.</span> <span class="toc-text">Service及时拉起</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#守护进程/进程互拉"><span class="toc-number">2.4.</span> <span class="toc-text">守护进程/进程互拉</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Linux_Am命令开启后台进程"><span class="toc-number">2.5.</span> <span class="toc-text">Linux Am命令开启后台进程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#NotificationListenerService通知"><span class="toc-number">2.6.</span> <span class="toc-text">NotificationListenerService通知</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#前台浮窗"><span class="toc-number">2.7.</span> <span class="toc-text">前台浮窗</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#新方法(AccountSync)"><span class="toc-number">3.</span> <span class="toc-text">新方法(AccountSync)</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#思路"><span class="toc-number">3.1.</span> <span class="toc-text">思路</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#效果"><span class="toc-number">3.2.</span> <span class="toc-text">效果</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#风险"><span class="toc-number">3.3.</span> <span class="toc-text">风险</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#实现_(核心代码)"><span class="toc-number">3.4.</span> <span class="toc-text">实现 (核心代码)</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Refs"><span class="toc-number">4.</span> <span class="toc-text">Refs</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#后记"><span class="toc-number">5.</span> <span class="toc-text">后记</span></a></li></ol>
                </div>
            
            <hr>
<h1 id="基础知识">基础知识</h1><h2 id="Android_进程优先级">Android 进程优先级</h2><p><strong>1 进程优先级等级一般分法</strong></p>
<ul>
<li>Activte process</li>
<li>Visible Process</li>
<li>Service process</li>
<li>Background process</li>
<li>Empty process</li>
</ul>
<p><strong>2 Service技巧</strong>  </p>
<ul>
<li>onStartCommand返回START_STICKY</li>
<li>onDestroy中startself </li>
<li>Service后台变前置，setForground(true) </li>
<li>android:persistent = “true” </li>
</ul>
<p><strong>3 进程优先级号</strong></p>
<p><strong><a href="https://android.googlesource.com/platform/frameworks/base/+/android-4.4.4_r1/services/java/com/android/server/am/ProcessList.java" target="_blank" rel="external">ProcessList.java</a></strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Adjustment used in certain places where we don't know it yet.</span></span><br><span class="line"><span class="comment">// (Generally this is something that is going to be cached, but we</span></span><br><span class="line"><span class="comment">// don't know the exact value in the cached range to assign yet.)</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> UNKNOWN_ADJ = <span class="number">16</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// This is a process only hosting activities that are not visible,</span></span><br><span class="line"><span class="comment">// so it can be killed without any disruption.</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> CACHED_APP_MAX_ADJ = <span class="number">15</span>;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> CACHED_APP_MIN_ADJ = <span class="number">9</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// The B list of SERVICE_ADJ -- these are the old and decrepit</span></span><br><span class="line"><span class="comment">// services that aren't as shiny and interesting as the ones in the A list.</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> SERVICE_B_ADJ = <span class="number">8</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// This is the process of the previous application that the user was in.</span></span><br><span class="line"><span class="comment">// This process is kept above other things, because it is very common to</span></span><br><span class="line"><span class="comment">// switch back to the previous app.  This is important both for recent</span></span><br><span class="line"><span class="comment">// task switch (toggling between the two top recent apps) as well as normal</span></span><br><span class="line"><span class="comment">// UI flow such as clicking on a URI in the e-mail app to view in the browser,</span></span><br><span class="line"><span class="comment">// and then pressing back to return to e-mail.</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> PREVIOUS_APP_ADJ = <span class="number">7</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// This is a process holding the home application -- we want to try</span></span><br><span class="line"><span class="comment">// avoiding killing it, even if it would normally be in the background,</span></span><br><span class="line"><span class="comment">// because the user interacts with it so much.</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> HOME_APP_ADJ = <span class="number">6</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// This is a process holding an application service -- killing it will not</span></span><br><span class="line"><span class="comment">// have much of an impact as far as the user is concerned.</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> SERVICE_ADJ = <span class="number">5</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// This is a process with a heavy-weight application.  It is in the</span></span><br><span class="line"><span class="comment">// background, but we want to try to avoid killing it.  Value set in</span></span><br><span class="line"><span class="comment">// system/rootdir/init.rc on startup.</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> HEAVY_WEIGHT_APP_ADJ = <span class="number">4</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// This is a process currently hosting a backup operation.  Killing it</span></span><br><span class="line"><span class="comment">// is not entirely fatal but is generally a bad idea.</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> BACKUP_APP_ADJ = <span class="number">3</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// This is a process only hosting components that are perceptible to the</span></span><br><span class="line"><span class="comment">// user, and we really want to avoid killing them, but they are not</span></span><br><span class="line"><span class="comment">// immediately visible. An example is background music playback.</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> PERCEPTIBLE_APP_ADJ = <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// This is a process only hosting activities that are visible to the</span></span><br><span class="line"><span class="comment">// user, so we'd prefer they don't disappear.</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> VISIBLE_APP_ADJ = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// This is the process running the current foreground app.  We'd really</span></span><br><span class="line"><span class="comment">// rather not kill it!</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> FOREGROUND_APP_ADJ = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// This is a process that the system or a persistent process has bound to,</span></span><br><span class="line"><span class="comment">// and indicated it is important.</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> PERSISTENT_SERVICE_ADJ = -<span class="number">11</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// This is a system persistent process, such as telephony.  Definitely</span></span><br><span class="line"><span class="comment">// don't want to kill it, but doing so is not completely fatal.</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> PERSISTENT_PROC_ADJ = -<span class="number">12</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// The system process runs at the default adjustment.</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> SYSTEM_ADJ = -<span class="number">16</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Special code for native processes that are not being managed by the system (so</span></span><br><span class="line"><span class="comment">// don't have an oom adj assigned by the system).</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> NATIVE_ADJ = -<span class="number">17</span>;</span><br></pre></td></tr></table></figure>
<h2 id="Android_Low_Memory_Killer">Android Low Memory Killer</h2><p>Android系统内存不足时，系统会杀掉一部分进程以释放空间，谁生谁死的这个生死大权就是由LMK所决定的，这就是Android系统中的Low Memory Killer，其基于Linux的OOM机制,其阈值定义如下面所示的lowmemorykiller文件中，当然也可以通过系统的init.rc实现自定义。<br><strong>lowmemorykiller.c</strong>   </p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="keyword">uint32_t</span> lowmem_debug_level = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">int</span> lowmem_adj[<span class="number">6</span>] = &#123;</span><br><span class="line">    <span class="number">0</span>,</span><br><span class="line">    <span class="number">1</span>,</span><br><span class="line">    <span class="number">6</span>,</span><br><span class="line">    <span class="number">12</span>,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">int</span> lowmem_adj_size = <span class="number">4</span>;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">int</span> lowmem_minfree[<span class="number">6</span>] = &#123;</span><br><span class="line">    <span class="number">3</span> * <span class="number">512</span>,    <span class="comment">/* 6MB */</span></span><br><span class="line">    <span class="number">2</span> * <span class="number">1024</span>,   <span class="comment">/* 8MB */</span></span><br><span class="line">    <span class="number">4</span> * <span class="number">1024</span>,   <span class="comment">/* 16MB */</span></span><br><span class="line">    <span class="number">16</span> * <span class="number">1024</span>,  <span class="comment">/* 64MB */</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">int</span> lowmem_minfree_size = <span class="number">4</span>;</span><br></pre></td></tr></table></figure>
<p><strong>①</strong> 在Low Memory Killer中通过进程的oom_adj与占用内存的大小决定要杀死的进程，<strong>oom_adj值越小越不容易被杀死</strong>。其中，lowmem_minfree是杀进程的时机，谁被杀，则取决于lowmem_adj，具体值得含义参考上面 <em>Android进程优先级</em> 所述.</p>
<p><strong>②</strong> 在init.rc中定义了init进程（系统进程）的oom_adj为<strong>-16</strong>，其不可能会被杀死(init的PID是1)，而前台进程是<strong>0</strong>（这里的前台进程是指用户正在使用的Activity所在的进程），用户按Home键回到桌面时的优先级是<strong>6</strong>，普通的Service的进程是<strong>8</strong>.<br><strong>init.rc</strong></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># Set init and its forked children's oom_adj.</span><br><span class="line">    write /proc/1/oom_adj -16</span><br></pre></td></tr></table></figure>
<p>关于Low Memory Killer的具体实现原理可参考Ref-2.</p>
<h2 id="查看某个App的进程">查看某个App的进程</h2><p>步骤（手机与PC连接）   </p>
<ol>
<li>adb shell  </li>
<li>ps | grep 进程名  </li>
<li>cat /proc/pid/oom_adj  //其中<strong>pid</strong>是上述grep得到的进程号  </li>
</ol>
<p><img src="http://7xo4q8.com1.z0.glb.clouddn.com/aenjon/2016/ps%20grep.png" alt=""></p>
<h2 id="Linux_AM命令">Linux AM命令</h2><p><strong>am命令</strong>：在Android系统中通过adb shell 启动某个Activity、Service、拨打电话、启动浏览器等操作Android的命令.其源码在Am.java中，在shell环境下执行am命令实际是启动一个线程执行Am.java中的主函数（main方法），am命令后跟的参数都会当做运行时参数传递到主函数中，主要实现在Am.java的run方法中。  </p>
<p><strong>拨打电话</strong><br>命令：am start -a android.intent.action.CALL -d tel:电话号码<br>示例：am start -a android.intent.action.CALL -d tel:10086  </p>
<p><strong>打开一个网页</strong><br>命令：am start -a android.intent.action.VIEW -d 网址<br>示例：am start -a android.intent.action.VIEW -d <a href="http://www.aenjon.com" target="_blank" rel="external">http://www.aenjon.com</a>  </p>
<p><strong>启动一个服务</strong><br>命令：am startservice &lt;服务名称&gt;<br>示例：am startservice -n com.android.music/  com.android.music.MediaPlaybackService</p>
<h2 id="NotificationListenerService">NotificationListenerService</h2><p>“A service that receives calls from the system when new notifications are posted or removed, or their ranking changed.” From Google</p>
<p>用来监听到通知的发送以及移除和排名位置变化,如果我们注册了这个服务，当系统任何一条通知到来或者被移除掉，我们都能通过这个service来监听到，甚至可以做一些管理工作。</p>
<h2 id="Android账号和同步机制">Android账号和同步机制</h2><p>属于Android中较偏冷的知识，具体参考 Ref 3 /4 /5  </p>
<h2 id="Android多进程">Android多进程</h2><ul>
<li><strong>实现</strong>：android:process</li>
<li><strong>好处</strong>：一个独立的进程可以充分利用自己的RAM预算,使其主进程拥有更多的空间处理资源。此外，操作系统对待运行在不同组件中的进程是不一样的。这意味着，当系统运行在低可用内存的条件时，并不是所有的进程都会被杀死</li>
<li><strong>大坑</strong>：每一个进程将有自己的Dalvik VM实例,意味着你不能通过这些实例共享数据,至少不是传统意义上的。例如,静态字段在每个进程都有自己的值,而不是你倾向于相信的只有一个值。</li>
<li>更多详细请参考Ref 9</li>
</ul>
<h1 id="现有方法">现有方法</h1><h2 id="网络连接保活方法">网络连接保活方法</h2><p>A. GCM<br>B. 公共的第三方push通道(信鸽等)<br>C. 自身跟服务器通过轮询，或者长连接<br>具体实现请参考 微信架构师杨干荣的”微信Android客户端后台保活经验分享” （Ref-1）.</p>
<h2 id="双service(通知栏)_提高进程优先级">双service(通知栏) 提高进程优先级</h2><p><strong>思路</strong>：（API level &gt; 18 ）   </p>
<ul>
<li>应用启动时启动一个假的Service（FakeService）, startForeground()，传一个空的Notification  </li>
<li>启动真正的Service（AlwaysLiveService），startForeground()，注意必须相同Notification ID  </li>
<li>FakeService stopForeground()  </li>
</ul>
<p><strong>效果</strong>：通过adb查看,运行在后台的服务其进程号变成了<strong>1</strong>（优先级仅次于前台进程）</p>
<p><strong>风险</strong>：Android系统前台service的一个漏洞，可能在6.0以上系统中修复</p>
<p><strong>实现</strong>：核心代码如下  </p>
<ul>
<li>AlwaysLiveService 常驻内存服务   </li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="annotation">@Override</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">onStartCommand</span><span class="params">(Intent intent, <span class="keyword">int</span> flags, <span class="keyword">int</span> startId)</span> </span>&#123;</span><br><span class="line">       startForeground(R.id.notify, <span class="keyword">new</span> Notification());</span><br><span class="line">       startService(<span class="keyword">new</span> Intent(<span class="keyword">this</span>, FakeService.class));</span><br><span class="line">       <span class="keyword">return</span> <span class="keyword">super</span>.onStartCommand(intent, flags, startId);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>FakeService 临时服务</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FakeService</span> <span class="keyword">extends</span> <span class="title">Service</span> </span>&#123;	</span><br><span class="line">    <span class="annotation">@Nullable</span></span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> IBinder <span class="title">onBind</span><span class="params">(Intent intent)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">onStartCommand</span><span class="params">(Intent intent, <span class="keyword">int</span> flags, <span class="keyword">int</span> startId)</span> </span>&#123;</span><br><span class="line">        startForeground(R.id.notify, <span class="keyword">new</span> Notification());</span><br><span class="line">        stopSelf();</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">super</span>.onStartCommand(intent, flags, startId);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onDestroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        stopForeground(<span class="keyword">true</span>);</span><br><span class="line">        <span class="keyword">super</span>.onDestroy();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Service及时拉起">Service及时拉起</h2><p>AlarmReceiver， ConnectReceiver，BootReceiver等  </p>
<ul>
<li>Service设置（见上面基础部分） </li>
<li>通过监听系统广播，如开机，锁屏，亮屏等重新启动服务 </li>
<li>通过alarm定时器，启动服务 </li>
</ul>
<h2 id="守护进程/进程互拉">守护进程/进程互拉</h2><p>在分析360手机助手app时，发现其拥有N多个进程，一个进程kill后会被其它未kill的进程拉起，这也是一种思路吧，虽然有点流氓~<br>守护进程一般有这样两种方式：  </p>
<ul>
<li>多个java进程守护互拉</li>
<li>底层C守护进程拉起App上层/java进程</li>
</ul>
<h2 id="Linux_Am命令开启后台进程">Linux Am命令开启后台进程</h2><p>一种底层实现让进程不被杀死的方法，在Android4.4以上可能有兼容性问题，具体参考Ref-7  </p>
<h2 id="NotificationListenerService通知">NotificationListenerService通知</h2><p>一种需要用户允许特定权限的系统拉起方式，4.3以上系统</p>
<h2 id="前台浮窗">前台浮窗</h2><p>有朋友提出一种应用退出后启动一个不可交互的浮窗，个人觉得这种方法是无效的，读者有兴趣可以一试  </p>
<h1 id="新方法(AccountSync)">新方法(AccountSync)</h1><h2 id="思路">思路</h2><p>利用Android系统提供的账号和同步机制实现</p>
<h2 id="效果">效果</h2><ul>
<li>通过adb查看,运行在后台的服务其进程号变成了1（优先级仅次于前台进程），能提高进程优先级，对比如下图 </li>
</ul>
<p><img src="http://7xo4q8.com1.z0.glb.clouddn.com/aenjon/2016/ps%20grep2.png" alt="正常情况"></p>
<p><img src="http://7xo4q8.com1.z0.glb.clouddn.com/aenjon/2016/ps%20grep1.png" alt="采用AccountSyncAdapter方法后"></p>
<ul>
<li>进程被系统kill后，可以由syn拉起</li>
</ul>
<h2 id="风险">风险</h2><ul>
<li>SyncAdapter时间进度不高，往往会因为手机处于休眠状态，而时间往后调整，同步间隔最低为<strong>1分钟</strong></li>
<li>用户可以单独停止或者删除，有些手机账号默认是不同步的，需要手动开启</li>
</ul>
<h2 id="实现_(核心代码)">实现 (核心代码)</h2><blockquote>
<p><strong>1 建立数据同步系统（ContentProvider）</strong>   </p>
</blockquote>
<p>通过一个ContentProvider用来作数据同步，由于并没有实际数据同步，所以此处就直接建立一个空的ContentProvider即可</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">XXAccountProvider</span> <span class="keyword">extends</span> <span class="title">ContentProvider</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String AUTHORITY = <span class="string">"包名.provider"</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String CONTENT_URI_BASE = <span class="string">"content://"</span> + AUTHORITY;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String TABLE_NAME = <span class="string">"data"</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> Uri CONTENT_URI = Uri.parse(CONTENT_URI_BASE + <span class="string">"/"</span> + TABLE_NAME);</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onCreate</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@Nullable</span></span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Cursor <span class="title">query</span><span class="params">(Uri uri, String[] projection, String selection,</span><br><span class="line">                        String[] selectionArgs, String sortOrder)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@Nullable</span></span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getType</span><span class="params">(Uri uri)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> String();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@Nullable</span></span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Uri <span class="title">insert</span><span class="params">(Uri uri, ContentValues values)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">delete</span><span class="params">(Uri uri, String selection, String[] selectionArgs)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">update</span><span class="params">(Uri uri, ContentValues values, String selection, String[] selectionArgs)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>然后再Manifest中声明  </p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">provider</span></span><br><span class="line">	<span class="attribute">android:name</span>=<span class="value">"**.XXAccountProvider"</span></span><br><span class="line">	<span class="attribute">android:authorities</span>=<span class="value">"@string/account_auth_provider"</span></span><br><span class="line">	<span class="attribute">android:exported</span>=<span class="value">"false"</span></span><br><span class="line">	<span class="attribute">android:syncable</span>=<span class="value">"true"</span>/&gt;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>2 建立Sync系统 (SyncAdapter) </strong>   </p>
</blockquote>
<p>通过实现SyncAdapter这个系统服务后, 利用系统的定时器对程序数据ContentProvider进行更新，具体步骤为：</p>
<ul>
<li>创建Sync服务</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">XXSyncService</span> <span class="keyword">extends</span> <span class="title">Service</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Object sSyncAdapterLock = <span class="keyword">new</span> Object();</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> XXSyncAdapter sSyncAdapter = <span class="keyword">null</span>;</span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">synchronized</span> (sSyncAdapterLock) &#123;</span><br><span class="line">            <span class="keyword">if</span> (sSyncAdapter == <span class="keyword">null</span>) &#123;</span><br><span class="line">                sSyncAdapter = <span class="keyword">new</span> XXSyncAdapter(getApplicationContext(), <span class="keyword">true</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> IBinder <span class="title">onBind</span><span class="params">(Intent intent)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> sSyncAdapter.getSyncAdapterBinder();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">XXSyncAdapter</span> <span class="keyword">extends</span> <span class="title">AbstractThreadedSyncAdapter</span> </span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">XXSyncAdapter</span><span class="params">(Context context, <span class="keyword">boolean</span> autoInitialize)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">super</span>(context, autoInitialize);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="annotation">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onPerformSync</span><span class="params">(Account account, Bundle extras, String authority, ContentProviderClient provider, SyncResult syncResult)</span> </span>&#123;</span><br><span class="line">            getContext().getContentResolver().notifyChange(XXAccountProvider.CONTENT_URI, <span class="keyword">null</span>, <span class="keyword">false</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>声明Sync服务 </li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">service</span></span><br><span class="line">	<span class="attribute">android:name</span>=<span class="value">"**.XXSyncService"</span></span><br><span class="line">	<span class="attribute">android:exported</span>=<span class="value">"true"</span></span><br><span class="line">	<span class="attribute">android:process</span>=<span class="value">":core"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">intent-filter</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">action</span></span><br><span class="line">			<span class="attribute">android:name</span>=<span class="value">"android.content.SyncAdapter"</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="title">intent-filter</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">meta-data</span></span><br><span class="line">		<span class="attribute">android:name</span>=<span class="value">"android.content.SyncAdapter"</span></span><br><span class="line">		<span class="attribute">android:resource</span>=<span class="value">"@xml/sync_adapter"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">service</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>其中sync_adapter为：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">sync-adapter</span> <span class="attribute">xmlns:android</span>=<span class="value">"http://schemas.android.com/apk/res/android"</span></span><br><span class="line">              <span class="attribute">android:accountType</span>=<span class="value">"@string/account_auth_type"</span></span><br><span class="line">              <span class="attribute">android:allowParallelSyncs</span>=<span class="value">"false"</span></span><br><span class="line">              <span class="attribute">android:contentAuthority</span>=<span class="value">"@string/account_auth_provide"</span></span><br><span class="line">              <span class="attribute">android:isAlwaysSyncable</span>=<span class="value">"true"</span></span><br><span class="line">              <span class="attribute">android:supportsUploading</span>=<span class="value">"false"</span></span><br><span class="line">              <span class="attribute">android:userVisible</span>=<span class="value">"true"</span>/&gt;</span></span><br></pre></td></tr></table></figure>
<p>参数说明：  </p>
<p>android:contentAuthority 指定要同步的ContentProvider在其AndroidManifest.xml文件中有个android:authorities属性。<br>android:accountType 表示进行同步的账号的类型。<br>android:userVisible 设置是否在“设置”中显示<br>android:supportsUploading 设置是否必须notifyChange通知才能同步<br>android:allowParallelSyncs 是否支持多账号同时同步<br>android:isAlwaysSyncable 设置所有账号的isSyncable为1<br>android:syncAdapterSettingsAction 指定一个可以设置同步的activity的Action。</p>
<ul>
<li>账户调用Sync服务<br>首先配置好Account（第三步），然后再通过ContentProvider实现<br>手动更新 </li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">triggerRefresh</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	Bundle b = <span class="keyword">new</span> Bundle();</span><br><span class="line">	b.putBoolean(ContentResolver.SYNC_EXTRAS_MANUAL, <span class="keyword">true</span>);</span><br><span class="line">	b.putBoolean(ContentResolver.SYNC_EXTRAS_EXPEDITED, <span class="keyword">true</span>);</span><br><span class="line">	ContentResolver.requestSync(</span><br><span class="line">			account,</span><br><span class="line">			CONTENT_AUTHORITY,</span><br><span class="line">			b);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>添加账号  </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Account account = AccountService.GetAccount(); </span><br><span class="line">AccountManager accountManager = (AccountManager) context.getSystemService(Context.ACCOUNT_SERVICE);</span><br><span class="line">accountManager.addAccountExplicitly(...)</span><br></pre></td></tr></table></figure>
<p>同步周期设置  </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ContentResolver.setIsSyncable(account, CONTENT_AUTHORITY, <span class="number">1</span>);</span><br><span class="line">ContentResolver.setSyncAutomatically(account, CONTENT_AUTHORITY, <span class="keyword">true</span>);</span><br><span class="line">ContentResolver.addPeriodicSync(account, CONTENT_AUTHORITY, <span class="keyword">new</span> Bundle(), SYNC_FREQUENCY);</span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>3 建立账号系统 (Account Authenticator)</strong>   </p>
</blockquote>
<p>通过建立Account账号，并关联SyncAdapter服务实现同步</p>
<ul>
<li>创建Account服务</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">XXAuthService</span> <span class="keyword">extends</span> <span class="title">Service</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> XXAuthenticator mAuthenticator;</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        mAuthenticator = <span class="keyword">new</span> XXAuthenticator(<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> XXAuthenticator <span class="title">getAuthenticator</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (mAuthenticator == <span class="keyword">null</span>)</span><br><span class="line">            mAuthenticator = <span class="keyword">new</span> XXAuthenticator(<span class="keyword">this</span>);</span><br><span class="line">        <span class="keyword">return</span> mAuthenticator;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> IBinder <span class="title">onBind</span><span class="params">(Intent intent)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> getAuthenticator().getIBinder();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">XXAuthenticator</span> <span class="keyword">extends</span> <span class="title">AbstractAccountAuthenticator</span> </span>&#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">final</span> Context context;</span><br><span class="line">        <span class="keyword">private</span> AccountManager accountManager;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">XXAuthenticator</span><span class="params">(Context context)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">super</span>(context);</span><br><span class="line">            <span class="keyword">this</span>.context = context;</span><br><span class="line">            accountManager = AccountManager.get(context);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="annotation">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> Bundle <span class="title">addAccount</span><span class="params">(AccountAuthenticatorResponse response, String accountType, String authTokenType, String[] requiredFeatures, Bundle options)</span></span><br><span class="line">                <span class="keyword">throws</span> NetworkErrorException </span>&#123;</span><br><span class="line">			<span class="comment">// 添加账号 示例代码</span></span><br><span class="line">            <span class="keyword">final</span> Bundle bundle = <span class="keyword">new</span> Bundle();</span><br><span class="line">            <span class="keyword">final</span> Intent intent = <span class="keyword">new</span> Intent(context, AuthActivity.class);</span><br><span class="line">            intent.putExtra(AccountManager.KEY_ACCOUNT_AUTHENTICATOR_RESPONSE, response);</span><br><span class="line">            bundle.putParcelable(AccountManager.KEY_INTENT, intent);</span><br><span class="line">            <span class="keyword">return</span> bundle;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="annotation">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> Bundle <span class="title">getAuthToken</span><span class="params">(AccountAuthenticatorResponse response, Account account, String authTokenType, Bundle options)</span></span><br><span class="line">                <span class="keyword">throws</span> NetworkErrorException </span>&#123;</span><br><span class="line">			<span class="comment">// 认证 示例代码</span></span><br><span class="line">            String authToken = accountManager.peekAuthToken(account, getString(R.string.account_token_type));</span><br><span class="line">            <span class="comment">//if not, might be expired, register again</span></span><br><span class="line">            <span class="keyword">if</span> (TextUtils.isEmpty(authToken)) &#123;</span><br><span class="line">                <span class="keyword">final</span> String password = accountManager.getPassword(account);</span><br><span class="line">                <span class="keyword">if</span> (password != <span class="keyword">null</span>) &#123;</span><br><span class="line">                    <span class="comment">//get new token</span></span><br><span class="line">					authToken = account.name + password;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//without password, need to sign again</span></span><br><span class="line">            <span class="keyword">final</span> Bundle bundle = <span class="keyword">new</span> Bundle();</span><br><span class="line">            <span class="keyword">if</span> (!TextUtils.isEmpty(authToken)) &#123;</span><br><span class="line">                bundle.putString(AccountManager.KEY_ACCOUNT_NAME, account.name);</span><br><span class="line">                bundle.putString(AccountManager.KEY_ACCOUNT_TYPE, account.type);</span><br><span class="line">                bundle.putString(AccountManager.KEY_AUTHTOKEN, authToken);</span><br><span class="line">                <span class="keyword">return</span> bundle;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//no account data at all, need to do a sign</span></span><br><span class="line">            <span class="keyword">final</span> Intent intent = <span class="keyword">new</span> Intent(context, AuthActivity.class);</span><br><span class="line">            intent.putExtra(AccountManager.KEY_ACCOUNT_AUTHENTICATOR_RESPONSE, response);</span><br><span class="line">            intent.putExtra(AuthActivity.ARG_ACCOUNT_NAME, account.name);</span><br><span class="line">            bundle.putParcelable(AccountManager.KEY_INTENT, intent);</span><br><span class="line">            <span class="keyword">return</span> bundle;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="annotation">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> String <span class="title">getAuthTokenLabel</span><span class="params">(String authTokenType)</span> </span>&#123;</span><br><span class="line"><span class="comment">//            throw new UnsupportedOperationException();</span></span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="annotation">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> Bundle <span class="title">editProperties</span><span class="params">(AccountAuthenticatorResponse response, String accountType)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="annotation">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> Bundle <span class="title">confirmCredentials</span><span class="params">(AccountAuthenticatorResponse response, Account account, Bundle options)</span></span><br><span class="line">                <span class="keyword">throws</span> NetworkErrorException </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="annotation">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> Bundle <span class="title">updateCredentials</span><span class="params">(AccountAuthenticatorResponse response, Account account, String authTokenType, Bundle options)</span></span><br><span class="line">                <span class="keyword">throws</span> NetworkErrorException </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="annotation">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> Bundle <span class="title">hasFeatures</span><span class="params">(AccountAuthenticatorResponse response, Account account, String[] features)</span></span><br><span class="line">                <span class="keyword">throws</span> NetworkErrorException </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>声明Account服务</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">service</span></span><br><span class="line">	<span class="attribute">android:name</span>=<span class="value">"**.XXAuthService"</span></span><br><span class="line">	<span class="attribute">android:exported</span>=<span class="value">"true"</span></span><br><span class="line">	<span class="attribute">android:process</span>=<span class="value">":core"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">intent-filter</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">action</span></span><br><span class="line">			<span class="attribute">android:name</span>=<span class="value">"android.accounts.AccountAuthenticator"</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="title">intent-filter</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">meta-data</span></span><br><span class="line">		<span class="attribute">android:name</span>=<span class="value">"android.accounts.AccountAuthenticator"</span></span><br><span class="line">		<span class="attribute">android:resource</span>=<span class="value">"@xml/authenticator"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">service</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>其中authenticator为：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="pi">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">account-authenticator</span> <span class="attribute">xmlns:android</span>=<span class="value">"http://schemas.android.com/apk/res/android"</span></span><br><span class="line">    <span class="attribute">android:accountType</span>=<span class="value">"@string/account_auth_type"</span></span><br><span class="line">    <span class="attribute">android:icon</span>=<span class="value">"@drawable/icon"</span></span><br><span class="line">    <span class="attribute">android:smallIcon</span>=<span class="value">"@drawable/icon"</span></span><br><span class="line">    <span class="attribute">android:label</span>=<span class="value">"@string/app_name"</span></span><br><span class="line">/&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li><p>使用Account服务<br>同SyncAdapter，通过AccountManager使用   </p>
<ul>
<li><p>申请Token主要是通过 <a href="https://developer.android.com/reference/android/accounts/AccountManager.html#getAuthToken(android.accounts.Account,%20java.lang.String,%20android.os.Bundle,%20android.app.Activity,%20android.accounts.AccountManagerCallback%3Candroid.os.Bundle%3E,%20android.os.Handler" target="_blank" rel="external">AccountManager.getAuthToken</a>)系列方法</p>
</li>
<li><p>添加账号则通过 <a href="https://developer.android.com/reference/android/accounts/AccountManager.html#addAccount(java.lang.String,%20java.lang.String,%20java.lang.String%5B%5D,%20android.os.Bundle,%20android.app.Activity,%20android.accounts.AccountManagerCallback%3Candroid.os.Bundle%3E,%20android.os.Handler" target="_blank" rel="external">AccountManager.addAccount</a>)</p>
</li>
<li><p>查看是否存在账号通过 <a href="https://developer.android.com/reference/android/accounts/AccountManager.html#getAccountsByType(java.lang.String" target="_blank" rel="external">AccountManager.getAccountsByType</a>)</p>
</li>
</ul>
</li>
</ul>
<h1 id="Refs">Refs</h1><ol>
<li><p><a href="http://mp.weixin.qq.com/s?__biz=MzA3ODg4MDk0Ng==&amp;mid=403254393&amp;idx=1&amp;sn=8dc0e3a03031177777b5a5876cb210cc&amp;scene=0#wechat_redirect" target="_blank" rel="external">微信Android客户端后台保活经验分享</a></p>
</li>
<li><p><a href="http://www.cnblogs.com/angeldevil/archive/2013/05/21/3090872.html" target="_blank" rel="external">Android Low Memory Killer原理</a></p>
</li>
<li><p><a href="http://stackoverflow.com/questions/10962418/startforeground-without-showing-notification/18281520#18281520" target="_blank" rel="external">stackOverflow 上介绍的双Service方法</a></p>
</li>
<li><p><a href="http://blog.udinic.com/2013/07/24/write-your-own-android-sync-adapter/" target="_blank" rel="external">Write your own Android Sync Adapter</a></p>
</li>
<li><p><a href="http://blog.udinic.com/2013/04/24/write-your-own-android-authenticator/" target="_blank" rel="external">Write your own Android Authenticator</a></p>
</li>
<li><p>Android developer</p>
<ul>
<li><a href="https://developer.android.com/reference/android/accounts/package-summary.html" target="_blank" rel="external">android.accounts</a> </li>
<li><a href="https://developer.android.com/reference/android/accounts/AccountManager.html" target="_blank" rel="external">AccountManager</a> </li>
<li><a href="https://developer.android.com/reference/android/accounts/AbstractAccountAuthenticator.html" target="_blank" rel="external">AbstractAccountAuthenticator</a>  </li>
<li><a href="https://developer.android.com/reference/android/accounts/AccountAuthenticatorActivity.html" target="_blank" rel="external">AccountAuthenticatorActivity</a></li>
<li><a href="https://developer.android.com/training/sync-adapters/creating-sync-adapter.html" target="_blank" rel="external">Creating a Sync Adapter</a></li>
</ul>
</li>
<li><p><a href="http://klob.diandi.life/?p=21" target="_blank" rel="external">Android篇从底层实现让进程不被杀死（失效Closed）</a>  </p>
</li>
<li><p><a href="http://hoyoshaw.github.io/2015/12/11/Android-4-3-NotificationListenerService-%E7%9A%84%E4%BD%BF%E7%94%A8/" target="_blank" rel="external">Android 4.3+ NotificationListenerService 的使用</a></p>
</li>
<li><p><a href="https://medium.com/@rotxed/going-multiprocess-on-android-52975ed8863c#.20jjl1u9h" target="_blank" rel="external">Going multiprocess on Android</a></p>
</li>
</ol>
<p><img src="https://camo.githubusercontent.com/8a7b101c1131bee44c083442109c44fb4a877261/687474703a2f2f377869386b6a2e636f6d312e7a302e676c622e636c6f7564646e2e636f6d2f696d6730312e676966" alt=""> </p>
<h1 id="后记">后记</h1><blockquote>
<p><strong>2016.5.24</strong>    </p>
</blockquote>
<p><strong>1. </strong>本文发布时间写错了，<strong>5.19</strong>手贱成了<strong>6.19</strong>，就酱紫吧，懒得改了，五月份看过的童鞋就当狠狠滴穿越了一把吧，O(∩_∩)O哈哈哈~~  </p>
<p><strong>2. </strong>本文在<a href="http://v2ex.com/t/280961" target="_blank" rel="external">V2EX</a>、<a href="http://gold.xitu.io/" target="_blank" rel="external">稀土掘金</a>、<a href="http://www.cnblogs.com/aenjon/p/5511612.html" target="_blank" rel="external">博客园</a>、<a href="http://blog.csdn.net/zgzhaobo/article/details/51462292" target="_blank" rel="external">CSDN</a>等等诸多网站上有转载或发布，收到了很多评论和讨论，其中有一部分以“天下兴亡匹夫有责”的心态批判笔者等同类开发者把Android生态给搞坏了，提到iOS的诸多好处等等，阐述几点个人观点：  </p>
<p><strong>① </strong>据笔者研究，目前双Service拉起的方式在国内排前几的应用(微信/支付宝等等)中都有用到，进程互拉方式在360手机助手、应用宝等应用中有用到，这些才是真正黑科技，笔者提到的方法仅仅是取巧性的用到了Android系统提供的方法，谈不上XXX~~  </p>
<p><strong>② </strong>iOS的封闭造就其天然的优势,不存在这些问题; 而Android的开源，有诸多问题但不可否认的是其促进了技术的发展，科技的发展甚至人类的进步。 物极必反，很多事情都是双刃剑~</p>
<p><strong>③</strong> 后来经一些网友提醒，发现所谓提异议的这群家伙都是产品汪，半吊子技术，所以XXOO~~</p>
<p><strong>④</strong> 法海无涯,技术无边,风涯无罪,南无阿弥陀佛~~</p>
<hr>
<font size="2"><br>By <a href="www.aenjon.com">aenjon</a>-2016<br></font>

<hr>
<p><strong><em>版权声明</em></strong></p>
<font size="1"><br> <a href="http://aenjon.com">aenjon</a> by <a href="http://aenjon.com/about">aenjon</a> is licensed under a <a href="http://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank" rel="external">Creative Commons BY-NC-ND 4.0 International License</a>.<br>由<a href="http://aenjon.com/about">Bob</a>创作并维护的<a href="http://aenjon.com">aenjon</a>博客采用<a href="http://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank" rel="external">创作共用保留署名-非商业-禁止演绎4.0国际许可证</a>.<br>本文首发于<a href="http://aenjon.com">aenjon</a>博客（ <a href="http://aenjon.com">http://aenjon.com</a> ），版权归作者所有，欢迎转载，但未经作者同意必须保留此段声明，且在文章页面明显位置给出原文连接，否则保留追究法律责任的权利。<br></font>

<p>微信扫码打赏<a href="http://aenjon.com">aenjon</a><br><img src="/css/images/aenjon_wx.png" alt=""> </p>
<p>如果您愿意捐助其它金额<a href="http://aenjon.com/about">请戳我~~</a>，扫码支付宝/微信</p>
<p>本文永久链接：<a href="http://aenjon.com/2016/06/19/Android/一种提高Android应用进程存活率新方法/">http://aenjon.com/2016/06/19/Android/一种提高Android应用进程存活率新方法/</a></p>

        
        </div>
        <footer class="article-footer">
            <div class="share-container">


    <div class="bdsharebuttonbox">
    <a href="#" class="bds_more" data-cmd="more">分享到：</a>
    <a href="#" class="bds_qzone" data-cmd="qzone" title="分享到QQ空间">QQ空间</a>
    <a href="#" class="bds_tsina" data-cmd="tsina" title="分享到新浪微博">新浪微博</a>
    <a href="#" class="bds_tqq" data-cmd="tqq" title="分享到腾讯微博">腾讯微博</a>
    <a href="#" class="bds_renren" data-cmd="renren" title="分享到人人网">人人网</a>
    <a href="#" class="bds_weixin" data-cmd="weixin" title="分享到微信">微信</a>
</div>
<script>
window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"0","bdSize":"16"},"share":{"bdSize":16}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];
</script>
<style>
    .bdshare_popup_box {
        border-radius: 4px;
        border: #e1e1e1 solid 1px;
    }
    .bdshare-button-style0-16 a,
    .bdshare-button-style0-16 .bds_more {
        padding-left: 20px;
        margin: 6px 10px 6px 0;
    }
    .bdshare_dialog_list a,
    .bdshare_popup_list a,
    .bdshare_popup_bottom a {
        font-family: 'Microsoft Yahei';
    }
    .bdshare_popup_top {
        display: none;
    }
    .bdshare_popup_bottom {
        height: auto;
        padding: 5px;
    }
</style>


</div>

            
    
        <a href="http://aenjon.com/2016/06/19/Android/一种提高Android应用进程存活率新方法/#comments" class="article-comment-link disqus-comment-count" data-disqus-url="http://aenjon.com/2016/06/19/Android/一种提高Android应用进程存活率新方法/">Comments</a>
    

        </footer>
    </div>
    
</article>



    <article id="post-AR_VR/一道Android OpenGL笔试题" class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
        
        
            <header class="article-header">
                
    
        <h1 itemprop="name">
            <a class="article-title" href="/2016/05/05/AR_VR/一道Android OpenGL笔试题/">一道Android OpenGL笔试题</a>
        </h1>
    

                <div class="article-meta">
                    
    <div class="article-date">
        <i class="fa fa-calendar"></i>
        <a href="/2016/05/05/AR_VR/一道Android OpenGL笔试题/">
            <time datetime="2016-05-05T01:40:20.000Z" itemprop="datePublished">2016-05-05</time>
        </a>
    </div>


                    
    <div class="article-category">
    	<i class="fa fa-folder"></i>
        <a class="article-category-link" href="/categories/Tech/">Tech</a><i class="fa fa-angle-right"></i><a class="article-category-link" href="/categories/Tech/OpenGL/">OpenGL</a>
    </div>

                    
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/tags/AR-VR/">AR/VR</a>, <a class="tag-link" href="/tags/Android/">Android</a>, <a class="tag-link" href="/tags/OpenGL/">OpenGL</a>
    </div>
          
					

					
                </div>
            </header>
        
        <div class="article-entry" itemprop="articleBody">
        
            
                <div id="toc" class="toc-article">
                <strong class="toc-title">Catalogue</strong>
                    <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#题目"><span class="toc-number">1.</span> <span class="toc-text">题目</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#答案"><span class="toc-number">2.</span> <span class="toc-text">答案</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#思考/讨论"><span class="toc-number">3.</span> <span class="toc-text">思考/讨论</span></a></li></ol>
                </div>
            
            <hr>
<h1 id="题目">题目</h1><ul>
<li>设计一个Android平台的Gallery组件，要求Gallery中每个item内的图片显示达成有效显示的最大精度，并保证Gallery在滚屏时能够全60FPS帧率地及时显示出加载的图片。请详细说明实现架构、关键技术点及APIs。</li>
<li>约束条件：GPU空间传输通道带宽较小，对于400*400pixel尺寸的图像而言，一次传输耗时超过30ms。</li>
</ul>
<h1 id="答案">答案</h1><p>当时的答案如下：</p>
<blockquote>
<p><strong> 1. Gallery组件类图</strong>   </p>
</blockquote>
<p>Gallery组件类图设计如下图所示，其中:  </p>
<ul>
<li>GalleryView为自定义Gallery组件视图;   </li>
<li>GalleryRenderer为GLSurfaceView的Renderer.  </li>
<li>AbstractImage为抽象的ImageView基类，子类继承实现loadGLTexture和Draw  </li>
<li>DataCache为图片缓存类，NetworkHelper为NetWork模块的管理类，负责图片的下载.  </li>
</ul>
<p><img src="http://7xo4q8.com1.z0.glb.clouddn.com/aenjon/2016/OpenGL-Gallery.jpg" alt="">    </p>
<blockquote>
<p><strong>2. 关键技术点及相关API设计</strong></p>
<blockquote>
<p>2.1 最大精度下60fps帧率显示图片  </p>
</blockquote>
</blockquote>
<p><strong>方案1： VBO/FBO方案</strong><br><strong><em>VBO</em></strong>(Vertex Buffer Array)： OpenGL存储顶点数据的高速缓存，可减少渲染时间，相关APIs如下(OpenGL ES 2.0以上)  </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">GLES20.glGenBuffers(<span class="number">1</span>, vboId, <span class="number">0</span>);<span class="comment">//申请</span></span><br><span class="line">GLES20.glBindBuffer(GLES30.GL_ARRAY_BUFFER, vboId[<span class="number">0</span>]);<span class="comment">//绑定</span></span><br><span class="line">GLES20.glBufferData(GLES30.GL_ARRAY_BUFFER, vertexBuffer.capacity() * <span class="number">4</span>,vertexBuffer,GLES30.GL_STATIC_DRAW);<span class="comment">//存储      </span></span><br><span class="line">GLES20.glBindBuffer(GLES30.GL_ARRAY_BUFFER, <span class="number">0</span>);</span><br></pre></td></tr></table></figure>
<p><a href="http://www.learnopengles.com/android-lesson-seven-an-introduction-to-vertex-buffer-objects-vbos/" target="_blank" rel="external">参考</a>   </p>
<p><strong><em>PBO</em></strong>(Pixel Buffer Object)：OpenGL存储像素数据的高速缓存，可实现快速的像素数据传递，减少数据的拷贝/传递时间，相关APIs如下(OpenGL ES 3.0以上)  </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">GLES30.glReadBuffer(GLES30.GL_BACK); <span class="comment">//set framebuffer to read from</span></span><br><span class="line">GLES30.glBindBuffer(GLES30.GL_PIXEL_PACK_BUFFER, mPboHandleContainer[<span class="number">0</span>]);  <span class="comment">// bind pbo</span></span><br><span class="line">GLES30.glReadPixels(<span class="number">0</span>, <span class="number">0</span>, width, height, GLES30.GL_RGBA, GLES30.GL_UNSIGNED_BYTE, pboByteBuffer); <span class="comment">// read pixels</span></span><br><span class="line">ByteBuffer byteBuffer =((ByteBuffer) GLES30.glMapBufferRange(GLES30.GL_PIXEL_PACK_BUFFER, <span class="number">0</span>, <span class="number">4</span> * mWidth * mHeight,</span><br><span class="line">                                              GLES30.GL_MAP_READ_BIT)).order(ByteOrder.nativeOrder()); <span class="comment">// map pbo to bb</span></span><br><span class="line">GLES30.glUnmapBuffer(GLES30.GL_PIXEL_PACK_BUFFER);<span class="comment">// unmap pbo</span></span><br><span class="line">GLES30.glBindBuffer(GLES30.GL_PIXEL_PACK_BUFFER, <span class="number">0</span>);<span class="comment">// unbind pbo</span></span><br></pre></td></tr></table></figure>
<p><strong>PBO DMA异步快速传递原理及多缓存对象设计</strong>  </p>
<ul>
<li>如下面两图所示，其中上图是传统的方法从图像源载入图像数据到纹理对象的过程，像素数据首先存到系统内存中，接着使用glTexImage2D将数据从系统内存拷贝到纹理对象，包含的两个子过程均需要有CPU执行；而下图中，像素数据是直接载入到PBO中，这个过程仍需要CPU来执行，但是从数据从PBO到纹理对象的过程则由GPU来执行DMA，不需要CPU参与。而且opengl可安排异步DMA，不必马上进行像素数据的传递。因此，相比而言，下图中的glTexImage2D立即返回而不是马上执行，这样CPU可以执行其它的操作而不需要等待像素数据传递的结束。</li>
</ul>
<p><img src="http://www.songho.ca/opengl/files/gl_pbo02.png" alt=""><br><img src="http://www.songho.ca/opengl/files/gl_pbo03.png" alt="">  </p>
<ul>
<li>如下图所示表示同时使用了两个PBO。在glTexSubImage2D将像素数据从PBO拷贝出来的同时，另一份像素数据写进了另一个PBO。即在第n帧时，PBO1用于glTexSubImage2D，而PBO2用于生成一个新的纹理对象了。再到n+1帧时，两个PBO则互换了角色。由于异步DMA传递，像素数据的更新和拷贝过程可同时进行，即CPU将纹理源更新到PBO，同时GPU将从另一PBO中拷贝出纹理，从而提高处理速度。<br><img src="http://www.songho.ca/opengl/files/gl_pbo04.png" alt=""></li>
</ul>
<p><a href="http://www.songho.ca/opengl/gl_pbo.html" target="_blank" rel="external">参考</a>（图片来源）</p>
<p><strong>方案二：Triple-Buffering等</strong>  </p>
<p><strong>Triple-Buffering基本思路</strong>：<br>frame N正在显示时，frameN+1已经缓存并准备好(Only ready to show)，frameN+2已经开始获取</p>
<p><strong>纹理索引基本思路</strong>：<br>所有图片都对应一个索引值，cache on memory，preloading，滑动时快速切换索引</p>
<blockquote>
<blockquote>
<p>2.2 Gallery组件架构    </p>
</blockquote>
</blockquote>
<p>Gallery组件是一个独立的模块，前期设计时需考虑后期的可维护性性及可可扩展性等进行综合考虑，<br>例如Gallery中图片的来源，可能来自本地或者网络下载，这样设计时需要将图片加载的模块单独抽离出来以便可扩展性等; 同时，从框架上考虑，Android组件的设计在具体情况下可考虑MVC/MVP等模式，这样不仅便于后期可维护可扩展，另外也能很好的将Model、View和Control/Presenter分离.</p>
<h1 id="思考/讨论">思考/讨论</h1><ul>
<li><p>由于该题是OpenGL题目，所以笔者在回答时重点侧重在图片的显示上，而对图片的加载直接忽略掉了，后面想一下，还是在上述答案中加上对Android中图片下载的多级缓存设计会比较好。  </p>
</li>
<li><p>OpenGL渲染深入 </p>
</li>
</ul>
<p>大家有好的答案或建议可直接下面留言回复，一起讨论! ~</p>
<hr>
<font size="2"><br>By aenjon-2016<br></font>

<hr>
<p><strong><em>版权声明</em></strong></p>
<font size="1"><br> <a href="http://aenjon.com">aenjon</a> by <a href="http://aenjon.com/about">aenjon</a> is licensed under a <a href="http://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank" rel="external">Creative Commons BY-NC-ND 4.0 International License</a>.<br>由<a href="http://aenjon.com/about">Bob</a>创作并维护的<a href="http://aenjon.com">aenjon</a>博客采用<a href="http://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank" rel="external">创作共用保留署名-非商业-禁止演绎4.0国际许可证</a>.<br>本文首发于<a href="http://aenjon.com">aenjon</a>博客（ <a href="http://aenjon.com">http://aenjon.com</a> ），版权归作者所有，欢迎转载，但未经作者同意必须保留此段声明，且在文章页面明显位置给出原文连接，否则保留追究法律责任的权利。<br></font>

<p>微信扫码打赏<a href="http://aenjon.com">aenjon</a><br><img src="/css/images/aenjon_wx.png" alt=""> </p>
<p>如果您愿意捐助其它金额<a href="http://aenjon.com/about">请戳我~~</a>，扫码支付宝/微信</p>
<p>本文永久链接：<a href="http://aenjon.com/2016/05/05/AR_VR/一道Android">http://aenjon.com/2016/05/05/AR_VR/一道Android</a> OpenGL笔试题/</p>

        
        </div>
        <footer class="article-footer">
            <div class="share-container">


    <div class="bdsharebuttonbox">
    <a href="#" class="bds_more" data-cmd="more">分享到：</a>
    <a href="#" class="bds_qzone" data-cmd="qzone" title="分享到QQ空间">QQ空间</a>
    <a href="#" class="bds_tsina" data-cmd="tsina" title="分享到新浪微博">新浪微博</a>
    <a href="#" class="bds_tqq" data-cmd="tqq" title="分享到腾讯微博">腾讯微博</a>
    <a href="#" class="bds_renren" data-cmd="renren" title="分享到人人网">人人网</a>
    <a href="#" class="bds_weixin" data-cmd="weixin" title="分享到微信">微信</a>
</div>
<script>
window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"0","bdSize":"16"},"share":{"bdSize":16}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];
</script>
<style>
    .bdshare_popup_box {
        border-radius: 4px;
        border: #e1e1e1 solid 1px;
    }
    .bdshare-button-style0-16 a,
    .bdshare-button-style0-16 .bds_more {
        padding-left: 20px;
        margin: 6px 10px 6px 0;
    }
    .bdshare_dialog_list a,
    .bdshare_popup_list a,
    .bdshare_popup_bottom a {
        font-family: 'Microsoft Yahei';
    }
    .bdshare_popup_top {
        display: none;
    }
    .bdshare_popup_bottom {
        height: auto;
        padding: 5px;
    }
</style>


</div>

            
    
        <a href="http://aenjon.com/2016/05/05/AR_VR/一道Android OpenGL笔试题/#comments" class="article-comment-link disqus-comment-count" data-disqus-url="http://aenjon.com/2016/05/05/AR_VR/一道Android OpenGL笔试题/">Comments</a>
    

        </footer>
    </div>
    
</article>



    <article id="post-aenjon/aenjon-Reading_Sharing-Life" class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
        
        
            <header class="article-header">
                
    
        <h1 itemprop="name">
            <a class="article-title" href="/2016/01/11/aenjon/aenjon-Reading_Sharing-Life/">aenjon-Reading Sharing-Life</a>
        </h1>
    

                <div class="article-meta">
                    
    <div class="article-date">
        <i class="fa fa-calendar"></i>
        <a href="/2016/01/11/aenjon/aenjon-Reading_Sharing-Life/">
            <time datetime="2016-01-10T17:23:20.000Z" itemprop="datePublished">2016-01-11</time>
        </a>
    </div>


                    
    <div class="article-category">
    	<i class="fa fa-folder"></i>
        <a class="article-category-link" href="/categories/aenjon/">aenjon</a><i class="fa fa-angle-right"></i><a class="article-category-link" href="/categories/aenjon/Reading/">Reading</a>
    </div>

                    
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/tags/Life/">Life</a>, <a class="tag-link" href="/tags/Reading/">Reading</a>, <a class="tag-link" href="/tags/aenjon/">aenjon</a>
    </div>
          
					

					
                </div>
            </header>
        
        <div class="article-entry" itemprop="articleBody">
        
            
            <hr>
<h2 id="2016">2016</h2><ul>
<li><a href="http://www.cnblogs.com/aenjon/p/5162149.html" target="_blank" rel="external">【讀書筆記】成为技术领导者</a></li>
</ul>
<h2 id="2016_before">2016 before</h2><ul>
<li><p><a href="http://www.cnblogs.com/aenjon/p/3895564.html" target="_blank" rel="external">【讀書筆記】精益创业实战</a></p>
</li>
<li><p><a href="http://www.cnblogs.com/aenjon/p/3693005.html" target="_blank" rel="external">【讀書筆記】高效能人士的七个习惯</a></p>
</li>
<li><p><a href="http://www.cnblogs.com/aenjon/p/3590471.html" target="_blank" rel="external">【讀書筆記】人人都是产品经理</a></p>
</li>
<li><p><a href="http://www.cnblogs.com/aenjon/archive/2013/01/07/2850003.html" target="_blank" rel="external">【分享】RSS订阅技巧及工具和实用RSS链接分享 </a></p>
</li>
</ul>
<hr>
<font size="2"><br>By aenjon<br></font>

<hr>
<p><strong><em>版权声明</em></strong></p>
<font size="1"><br> <a href="http://aenjon.com">aenjon</a> by <a href="http://aenjon.com/about">aenjon</a> is licensed under a <a href="http://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank" rel="external">Creative Commons BY-NC-ND 4.0 International License</a>.<br>由<a href="http://aenjon.com/about">Bob</a>创作并维护的<a href="http://aenjon.com">aenjon</a>博客采用<a href="http://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank" rel="external">创作共用保留署名-非商业-禁止演绎4.0国际许可证</a>.<br>本文首发于<a href="http://aenjon.com">aenjon</a>博客（ <a href="http://aenjon.com">http://aenjon.com</a> ），版权归作者所有，欢迎转载，但未经作者同意必须保留此段声明，且在文章页面明显位置给出原文连接，否则保留追究法律责任的权利。<br></font>

<p>微信扫码打赏<a href="http://aenjon.com">aenjon</a><br><img src="/css/images/aenjon_wx.png" alt=""> </p>
<p>如果您愿意捐助其它金额<a href="http://aenjon.com/about">请戳我~~</a>，扫码支付宝/微信</p>
<p>本文永久链接：<a href="http://aenjon.com/2016/01/11/aenjon/aenjon-Reading_Sharing-Life/">http://aenjon.com/2016/01/11/aenjon/aenjon-Reading_Sharing-Life/</a></p>

        
        </div>
        <footer class="article-footer">
            <div class="share-container">


    <div class="bdsharebuttonbox">
    <a href="#" class="bds_more" data-cmd="more">分享到：</a>
    <a href="#" class="bds_qzone" data-cmd="qzone" title="分享到QQ空间">QQ空间</a>
    <a href="#" class="bds_tsina" data-cmd="tsina" title="分享到新浪微博">新浪微博</a>
    <a href="#" class="bds_tqq" data-cmd="tqq" title="分享到腾讯微博">腾讯微博</a>
    <a href="#" class="bds_renren" data-cmd="renren" title="分享到人人网">人人网</a>
    <a href="#" class="bds_weixin" data-cmd="weixin" title="分享到微信">微信</a>
</div>
<script>
window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"0","bdSize":"16"},"share":{"bdSize":16}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];
</script>
<style>
    .bdshare_popup_box {
        border-radius: 4px;
        border: #e1e1e1 solid 1px;
    }
    .bdshare-button-style0-16 a,
    .bdshare-button-style0-16 .bds_more {
        padding-left: 20px;
        margin: 6px 10px 6px 0;
    }
    .bdshare_dialog_list a,
    .bdshare_popup_list a,
    .bdshare_popup_bottom a {
        font-family: 'Microsoft Yahei';
    }
    .bdshare_popup_top {
        display: none;
    }
    .bdshare_popup_bottom {
        height: auto;
        padding: 5px;
    }
</style>


</div>

            
    
        <a href="http://aenjon.com/2016/01/11/aenjon/aenjon-Reading_Sharing-Life/#comments" class="article-comment-link disqus-comment-count" data-disqus-url="http://aenjon.com/2016/01/11/aenjon/aenjon-Reading_Sharing-Life/">Comments</a>
    

        </footer>
    </div>
    
</article>



    <nav id="page-nav">
        <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/">Next &raquo;</a>
    </nav>
</section>
            
                <aside id="sidebar">
   
        
    <div class="widget-wrap">
        <h3 class="widget-title">recent</h3>
        <div class="widget">
            <ul id="recent-post" class="">
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2016/10/31/aenjon/Life/而立之年，未开始的创业路/" class="thumbnail">
    
    
        <span style="background-image:url(http://aenjon.com/css/images/avatar.png)" alt="而立之年，未开始的创业路" class="thumbnail-image"></span>
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/aenjon/">aenjon</a><i class="fa fa-angle-right"></i><a class="article-category-link" href="/categories/aenjon/Life/">Life</a></p>
                            <p class="item-title"><a href="/2016/10/31/aenjon/Life/而立之年，未开始的创业路/" class="title">而立之年，未开始的创业路</a></p>
                            <p class="item-date"><time datetime="2016-10-30T16:30:30.000Z" itemprop="datePublished">2016-10-31</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2016/07/18/Tools/Jenkins Gitlab持续集成打包平台搭建/" class="thumbnail">
    
    
        <span style="background-image:url(https://jenkins.io/images/226px-Jenkins_logo.svg.png)" alt="Jenkins Gitlab持续集成打包平台搭建" class="thumbnail-image"></span>
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/Tech/">Tech</a><i class="fa fa-angle-right"></i><a class="article-category-link" href="/categories/Tech/Tools/">Tools</a></p>
                            <p class="item-title"><a href="/2016/07/18/Tools/Jenkins Gitlab持续集成打包平台搭建/" class="title">Jenkins Gitlab持续集成打包平台搭建</a></p>
                            <p class="item-date"><time datetime="2016-07-17T16:00:00.000Z" itemprop="datePublished">2016-07-18</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2016/06/30/iOS/Select all the cell in UITabView or UICollectionView problem/" class="thumbnail">
    
    
        <span style="background-image:url(https://devimages.apple.com.edgekey.net/assets/elements/icons/swift/swift-64x64.png)" alt="Select all the cell in UITabView or UICollectionView problem" class="thumbnail-image"></span>
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/Tech/">Tech</a><i class="fa fa-angle-right"></i><a class="article-category-link" href="/categories/Tech/iOS/">iOS</a></p>
                            <p class="item-title"><a href="/2016/06/30/iOS/Select all the cell in UITabView or UICollectionView problem/" class="title">Select all the cell in UITabView or UICollectionView problem</a></p>
                            <p class="item-date"><time datetime="2016-06-29T16:40:20.000Z" itemprop="datePublished">2016-06-30</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2016/06/19/Android/一种提高Android应用进程存活率新方法/" class="thumbnail">
    
    
        <span style="background-image:url(http://7xo4q8.com1.z0.glb.clouddn.com/aenjon/2016/ps%20grep1.png)" alt="一种提高Android应用进程存活率新方法" class="thumbnail-image"></span>
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/Tech/">Tech</a><i class="fa fa-angle-right"></i><a class="article-category-link" href="/categories/Tech/Android/">Android</a></p>
                            <p class="item-title"><a href="/2016/06/19/Android/一种提高Android应用进程存活率新方法/" class="title">一种提高Android应用进程存活率新方法</a></p>
                            <p class="item-date"><time datetime="2016-06-18T16:40:20.000Z" itemprop="datePublished">2016-06-19</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2016/05/05/AR_VR/一道Android OpenGL笔试题/" class="thumbnail">
    
    
        <span style="background-image:url(http://7xo4q8.com1.z0.glb.clouddn.com/aenjon/2016/OpenGL-Gallery.jpg)" alt="一道Android OpenGL笔试题" class="thumbnail-image"></span>
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/Tech/">Tech</a><i class="fa fa-angle-right"></i><a class="article-category-link" href="/categories/Tech/OpenGL/">OpenGL</a></p>
                            <p class="item-title"><a href="/2016/05/05/AR_VR/一道Android OpenGL笔试题/" class="title">一道Android OpenGL笔试题</a></p>
                            <p class="item-date"><time datetime="2016-05-05T01:40:20.000Z" itemprop="datePublished">2016-05-05</time></p>
                        </div>
                    </li>
                
            </ul>
        </div>
    </div>

    
        
    <div class="widget-wrap">
        <h3 class="widget-title">categories</h3>
        <div class="widget">
            <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/aenjon/">aenjon</a><span class="category-list-count">4</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/aenjon/Life/">Life</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/aenjon/Reading/">Reading</a><span class="category-list-count">1</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Tech/">Tech</a><span class="category-list-count">13</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Tech/Android/">Android</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Tech/CV/">CV</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Tech/Media/">Media</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Tech/NFC/">NFC</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Tech/OpenGL/">OpenGL</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Tech/Tools/">Tools</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Tech/iOS/">iOS</a><span class="category-list-count">2</span></li></ul></li></ul>
        </div>
    </div>

    
        
    <div class="widget-wrap">
        <h3 class="widget-title">tag cloud</h3>
        <div class="widget tagcloud">
            <a href="/tags/AR-VR/" style="font-size: 10px;">AR/VR</a> <a href="/tags/Android/" style="font-size: 20px;">Android</a> <a href="/tags/CI/" style="font-size: 10px;">CI</a> <a href="/tags/CV-MV/" style="font-size: 18px;">CV/MV</a> <a href="/tags/DIP/" style="font-size: 18px;">DIP</a> <a href="/tags/Gitlab/" style="font-size: 10px;">Gitlab</a> <a href="/tags/H264/" style="font-size: 10px;">H264</a> <a href="/tags/Jenkins/" style="font-size: 10px;">Jenkins</a> <a href="/tags/Life/" style="font-size: 16px;">Life</a> <a href="/tags/NFC/" style="font-size: 10px;">NFC</a> <a href="/tags/OpenCV/" style="font-size: 18px;">OpenCV</a> <a href="/tags/OpenGL/" style="font-size: 10px;">OpenGL</a> <a href="/tags/Project/" style="font-size: 10px;">Project</a> <a href="/tags/Reading/" style="font-size: 10px;">Reading</a> <a href="/tags/aenjon/" style="font-size: 16px;">aenjon</a> <a href="/tags/Swift/" style="font-size: 10px;">Swift</a> <a href="/tags/iOS/" style="font-size: 14px;">iOS</a> <a href="/tags/jrtplib/" style="font-size: 10px;">jrtplib</a> <a href="/tags/live555/" style="font-size: 10px;">live555</a> <a href="/tags/图像特征/" style="font-size: 10px;">图像特征</a> <a href="/tags/图像算法/" style="font-size: 18px;">图像算法</a> <a href="/tags/存活率/" style="font-size: 10px;">存活率</a> <a href="/tags/彩色图像/" style="font-size: 12px;">彩色图像</a> <a href="/tags/机器视觉/" style="font-size: 10px;">机器视觉</a> <a href="/tags/流媒体/" style="font-size: 10px;">流媒体</a> <a href="/tags/瑕疵检测/" style="font-size: 10px;">瑕疵检测</a> <a href="/tags/进程/" style="font-size: 10px;">进程</a>
        </div>
    </div>

    
        
    <div class="widget-wrap widget-list">
        <h3 class="widget-title">links</h3>
        <div class="widget">
            <ul>
                
                    <li>
                        <a href="http://www.cnblogs.com/aenjon/">aenjon-cnBlogs</a>
                    </li>
                
            </ul>
        </div>
    </div>


    
    <div id="toTop" class="fa fa-angle-up"></div>
</aside>
            
        </div>
        <footer id="footer">
    <div class="outer">
        <div id="footer-info" class="inner">
            &copy; 2016 aenjon<br>
            Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>. Modified by <a href="http://aenjon.com">aenjon</a>.Total <span id="busuanzi_value_site_pv"></span> views.
        </div>
    </div>
</footer>
<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>
        
    
    <script>
    var disqus_shortname = 'aenjon';
    
    
    (function() {
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/count.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
    </script>



    
        <script src="/vendor/fancybox/jquery.fancybox.pack.js" type="text/javascript"></script>
    


<!-- Custom Scripts -->
<script src="/js/main.js" type="text/javascript"></script>

    </div>
</body>
</html>